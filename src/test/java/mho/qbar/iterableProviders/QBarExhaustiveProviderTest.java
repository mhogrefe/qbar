package mho.qbar.iterableProviders;

import mho.qbar.objects.Interval;
import mho.qbar.objects.Rational;
import org.jetbrains.annotations.NotNull;
import org.junit.Test;

import static mho.qbar.testing.QBarTesting.QEP;
import static mho.wheels.testing.Testing.*;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

public class QBarExhaustiveProviderTest {
    private static <T> void simpleProviderHelper(@NotNull Iterable<T> xs, @NotNull String output) {
        aeqitLimit(SMALLER_LIMIT, xs, output);
        testNoRemove(SMALLER_LIMIT, xs);
    }

    @Test
    public void testPositiveRationals() {
        simpleProviderHelper(QEP.positiveRationals(),
                "[1, 1/2, 2, 1/3, 1/4, 2/3, 3, 3/2, 4, 3/4, 4/3, 1/5, 1/6, 2/5, 1/7, 1/8, 2/7, 3/5, 4/5, 3/7, 3/8," +
                " 4/7, 5, 5/2, 6, 5/3, 5/4, 7, 7/2, 8, 7/3, 7/4, 8/3, 5/6, 6/5, 5/7, 5/8, 6/7, 7/5, 7/6, 8/5, 7/8," +
                " 8/7, 1/9, 1/10, 2/9, 1/11, 1/12, 2/11, 3/10, ...]");
    }

    @Test
    public void testNegativeRationals() {
        simpleProviderHelper(QEP.negativeRationals(),
                "[-1, -1/2, -2, -1/3, -1/4, -2/3, -3, -3/2, -4, -3/4, -4/3, -1/5, -1/6, -2/5, -1/7, -1/8, -2/7," +
                " -3/5, -4/5, -3/7, -3/8, -4/7, -5, -5/2, -6, -5/3, -5/4, -7, -7/2, -8, -7/3, -7/4, -8/3, -5/6," +
                " -6/5, -5/7, -5/8, -6/7, -7/5, -7/6, -8/5, -7/8, -8/7, -1/9, -1/10, -2/9, -1/11, -1/12, -2/11," +
                " -3/10, ...]");
    }

    @Test
    public void testNonzeroRationals() {
        simpleProviderHelper(QEP.nonzeroRationals(),
                "[1, 1/2, -1, -1/2, 1/3, 1/4, -1/3, -1/4, 2, -2, 2/3, -2/3, 1/5, 1/6, -1/5, -1/6, 1/7, 1/8, -1/7," +
                " -1/8, 2/5, -2/5, 2/7, -2/7, 3, 3/2, -3, -3/2, 3/4, -3/4, 4, -4, 4/3, -4/3, 3/5, -3/5, 3/7, 3/8," +
                " -3/7, -3/8, 4/5, -4/5, 4/7, -4/7, 1/9, 1/10, -1/9, -1/10, 1/11, 1/12, ...]");
    }

    @Test
    public void testRationals() {
        simpleProviderHelper(QEP.rationals(),
                "[0, 1, 1/2, 1/3, 1/4, -1, -1/2, 2, -1/3, -1/4, 2/3, 1/5, 1/6, 1/7, 1/8, -1/5, -1/6, 2/5, -1/7," +
                " -1/8, 2/7, -2, 3, 3/2, -2/3, 3/4, -3, -3/2, 4, -3/4, 4/3, -2/5, 3/5, -2/7, 3/7, 3/8, -3/5, 4/5," +
                " -3/7, -3/8, 4/7, 1/9, 1/10, 1/11, 1/12, -1/9, -1/10, 2/9, -1/11, -1/12, ...]");
    }

    @Test
    public void testNonNegativeRationalsLessThanOne() {
        simpleProviderHelper(QEP.nonNegativeRationalsLessThanOne(),
                "[0, 1/2, 1/3, 2/3, 1/4, 3/4, 1/5, 2/5, 3/5, 4/5, 1/6, 5/6, 1/7, 2/7, 3/7, 4/7, 5/7, 6/7, 1/8, 3/8," +
                " 5/8, 7/8, 1/9, 2/9, 4/9, 5/9, 7/9, 8/9, 1/10, 3/10, 7/10, 9/10, 1/11, 2/11, 3/11, 4/11, 5/11," +
                " 6/11, 7/11, 8/11, 9/11, 10/11, 1/12, 5/12, 7/12, 11/12, 1/13, 2/13, 3/13, 4/13, ...]");
    }

    private static void rangeUp_Rational_helper(@NotNull String a, @NotNull String output) {
        simpleProviderHelper(QEP.rangeUp(Rational.read(a).get()), output);
    }

    @Test
    public void testRangeUp_Rational() {
        rangeUp_Rational_helper("0",
                "[0, 1, 1/2, 2, 1/3, 1/4, 2/3, 3, 3/2, 4, 3/4, 4/3, 1/5, 1/6, 2/5, 1/7, 1/8, 2/7, 3/5, 4/5, 3/7," +
                " 3/8, 4/7, 5, 5/2, 6, 5/3, 5/4, 7, 7/2, 8, 7/3, 7/4, 8/3, 5/6, 6/5, 5/7, 5/8, 6/7, 7/5, 7/6, 8/5," +
                " 7/8, 8/7, 1/9, 1/10, 2/9, 1/11, 1/12, 2/11, ...]");
        rangeUp_Rational_helper("1",
                "[1, 2, 3/2, 3, 4/3, 5/4, 5/3, 4, 5/2, 5, 7/4, 7/3, 6/5, 7/6, 7/5, 8/7, 9/8, 9/7, 8/5, 9/5, 10/7," +
                " 11/8, 11/7, 6, 7/2, 7, 8/3, 9/4, 8, 9/2, 9, 10/3, 11/4, 11/3, 11/6, 11/5, 12/7, 13/8, 13/7, 12/5," +
                " 13/6, 13/5, 15/8, 15/7, 10/9, 11/10, 11/9, 12/11, 13/12, 13/11, ...]");
        rangeUp_Rational_helper("2",
                "[2, 3, 5/2, 4, 7/3, 9/4, 8/3, 5, 7/2, 6, 11/4, 10/3, 11/5, 13/6, 12/5, 15/7, 17/8, 16/7, 13/5," +
                " 14/5, 17/7, 19/8, 18/7, 7, 9/2, 8, 11/3, 13/4, 9, 11/2, 10, 13/3, 15/4, 14/3, 17/6, 16/5, 19/7," +
                " 21/8, 20/7, 17/5, 19/6, 18/5, 23/8, 22/7, 19/9, 21/10, 20/9, 23/11, 25/12, 24/11, ...]");
        rangeUp_Rational_helper("-2",
                "[-2, -1, -3/2, 0, -5/3, -7/4, -4/3, 1, -1/2, 2, -5/4, -2/3, -9/5, -11/6, -8/5, -13/7, -15/8, -12/7," +
                " -7/5, -6/5, -11/7, -13/8, -10/7, 3, 1/2, 4, -1/3, -3/4, 5, 3/2, 6, 1/3, -1/4, 2/3, -7/6, -4/5," +
                " -9/7, -11/8, -8/7, -3/5, -5/6, -2/5, -9/8, -6/7, -17/9, -19/10, -16/9, -21/11, -23/12, -20/11," +
                " ...]");
        rangeUp_Rational_helper("5/3",
                "[5/3, 8/3, 13/6, 11/3, 2, 23/12, 7/3, 14/3, 19/6, 17/3, 29/12, 3, 28/15, 11/6, 31/15, 38/21, 43/24," +
                " 41/21, 34/15, 37/15, 44/21, 49/24, 47/21, 20/3, 25/6, 23/3, 10/3, 35/12, 26/3, 31/6, 29/3, 4," +
                " 41/12, 13/3, 5/2, 43/15, 50/21, 55/24, 53/21, 46/15, 17/6, 49/15, 61/24, 59/21, 16/9, 53/30, 17/9," +
                " 58/33, 7/4, 61/33, ...]");
        rangeUp_Rational_helper("-5/3",
                "[-5/3, -2/3, -7/6, 1/3, -4/3, -17/12, -1, 4/3, -1/6, 7/3, -11/12, -1/3, -22/15, -3/2, -19/15," +
                " -32/21, -37/24, -29/21, -16/15, -13/15, -26/21, -31/24, -23/21, 10/3, 5/6, 13/3, 0, -5/12, 16/3," +
                " 11/6, 19/3, 2/3, 1/12, 1, -5/6, -7/15, -20/21, -25/24, -17/21, -4/15, -1/2, -1/15, -19/24, -11/21," +
                " -14/9, -47/30, -13/9, -52/33, -19/12, -49/33, ...]");
    }

    private static void rangeDown_Rational_helper(@NotNull String a, @NotNull String output) {
        simpleProviderHelper(QEP.rangeDown(Rational.read(a).get()), output);
    }

    @Test
    public void testRangeDown_Rational() {
        rangeDown_Rational_helper("0",
                "[0, -1, -1/2, -2, -1/3, -1/4, -2/3, -3, -3/2, -4, -3/4, -4/3, -1/5, -1/6, -2/5, -1/7, -1/8, -2/7," +
                " -3/5, -4/5, -3/7, -3/8, -4/7, -5, -5/2, -6, -5/3, -5/4, -7, -7/2, -8, -7/3, -7/4, -8/3, -5/6," +
                " -6/5, -5/7, -5/8, -6/7, -7/5, -7/6, -8/5, -7/8, -8/7, -1/9, -1/10, -2/9, -1/11, -1/12, -2/11, ...]");
        rangeDown_Rational_helper("1",
                "[1, 0, 1/2, -1, 2/3, 3/4, 1/3, -2, -1/2, -3, 1/4, -1/3, 4/5, 5/6, 3/5, 6/7, 7/8, 5/7, 2/5, 1/5," +
                " 4/7, 5/8, 3/7, -4, -3/2, -5, -2/3, -1/4, -6, -5/2, -7, -4/3, -3/4, -5/3, 1/6, -1/5, 2/7, 3/8, 1/7," +
                " -2/5, -1/6, -3/5, 1/8, -1/7, 8/9, 9/10, 7/9, 10/11, 11/12, 9/11, ...]");
        rangeDown_Rational_helper("2",
                "[2, 1, 3/2, 0, 5/3, 7/4, 4/3, -1, 1/2, -2, 5/4, 2/3, 9/5, 11/6, 8/5, 13/7, 15/8, 12/7, 7/5, 6/5," +
                " 11/7, 13/8, 10/7, -3, -1/2, -4, 1/3, 3/4, -5, -3/2, -6, -1/3, 1/4, -2/3, 7/6, 4/5, 9/7, 11/8, 8/7," +
                " 3/5, 5/6, 2/5, 9/8, 6/7, 17/9, 19/10, 16/9, 21/11, 23/12, 20/11, ...]");
        rangeDown_Rational_helper("-2",
                "[-2, -3, -5/2, -4, -7/3, -9/4, -8/3, -5, -7/2, -6, -11/4, -10/3, -11/5, -13/6, -12/5, -15/7, -17/8," +
                " -16/7, -13/5, -14/5, -17/7, -19/8, -18/7, -7, -9/2, -8, -11/3, -13/4, -9, -11/2, -10, -13/3," +
                " -15/4, -14/3, -17/6, -16/5, -19/7, -21/8, -20/7, -17/5, -19/6, -18/5, -23/8, -22/7, -19/9, -21/10," +
                " -20/9, -23/11, -25/12, -24/11, ...]");
        rangeDown_Rational_helper("5/3",
                "[5/3, 2/3, 7/6, -1/3, 4/3, 17/12, 1, -4/3, 1/6, -7/3, 11/12, 1/3, 22/15, 3/2, 19/15, 32/21, 37/24," +
                " 29/21, 16/15, 13/15, 26/21, 31/24, 23/21, -10/3, -5/6, -13/3, 0, 5/12, -16/3, -11/6, -19/3, -2/3," +
                " -1/12, -1, 5/6, 7/15, 20/21, 25/24, 17/21, 4/15, 1/2, 1/15, 19/24, 11/21, 14/9, 47/30, 13/9," +
                " 52/33, 19/12, 49/33, ...]");
        rangeDown_Rational_helper("-5/3",
                "[-5/3, -8/3, -13/6, -11/3, -2, -23/12, -7/3, -14/3, -19/6, -17/3, -29/12, -3, -28/15, -11/6," +
                " -31/15, -38/21, -43/24, -41/21, -34/15, -37/15, -44/21, -49/24, -47/21, -20/3, -25/6, -23/3," +
                " -10/3, -35/12, -26/3, -31/6, -29/3, -4, -41/12, -13/3, -5/2, -43/15, -50/21, -55/24, -53/21," +
                " -46/15, -17/6, -49/15, -61/24, -59/21, -16/9, -53/30, -17/9, -58/33, -7/4, -61/33, ...]");
    }

    private static void range_Rational_Rational_helper(@NotNull String a, @NotNull String b, @NotNull String output) {
        simpleProviderHelper(QEP.range(Rational.read(a).get(), Rational.read(b).get()), output);
    }

    @Test
    public void testRange_Rational_Rational() {
        range_Rational_Rational_helper("1", "0", "[]");
        range_Rational_Rational_helper("1/2", "1/3", "[]");
        range_Rational_Rational_helper("0", "0", "[0]");
        range_Rational_Rational_helper("5/3", "5/3", "[5/3]");
        range_Rational_Rational_helper("0", "1",
                "[0, 1, 1/2, 1/3, 2/3, 1/4, 3/4, 1/5, 2/5, 3/5, 4/5, 1/6, 5/6, 1/7, 2/7, 3/7, 4/7, 5/7, 6/7, 1/8," +
                " 3/8, 5/8, 7/8, 1/9, 2/9, 4/9, 5/9, 7/9, 8/9, 1/10, 3/10, 7/10, 9/10, 1/11, 2/11, 3/11, 4/11, 5/11," +
                " 6/11, 7/11, 8/11, 9/11, 10/11, 1/12, 5/12, 7/12, 11/12, 1/13, 2/13, 3/13, ...]");
        range_Rational_Rational_helper("-1", "0",
                "[-1, 0, -1/2, -2/3, -1/3, -3/4, -1/4, -4/5, -3/5, -2/5, -1/5, -5/6, -1/6, -6/7, -5/7, -4/7, -3/7," +
                " -2/7, -1/7, -7/8, -5/8, -3/8, -1/8, -8/9, -7/9, -5/9, -4/9, -2/9, -1/9, -9/10, -7/10, -3/10," +
                " -1/10, -10/11, -9/11, -8/11, -7/11, -6/11, -5/11, -4/11, -3/11, -2/11, -1/11, -11/12, -7/12," +
                " -5/12, -1/12, -12/13, -11/13, -10/13, ...]");
        range_Rational_Rational_helper("1/3", "1/2",
                "[1/3, 1/2, 5/12, 7/18, 4/9, 3/8, 11/24, 11/30, 2/5, 13/30, 7/15, 13/36, 17/36, 5/14, 8/21, 17/42," +
                " 3/7, 19/42, 10/21, 17/48, 19/48, 7/16, 23/48, 19/54, 10/27, 11/27, 23/54, 25/54, 13/27, 7/20," +
                " 23/60, 9/20, 29/60, 23/66, 4/11, 25/66, 13/33, 9/22, 14/33, 29/66, 5/11, 31/66, 16/33, 25/72," +
                " 29/72, 31/72, 35/72, 9/26, 14/39, 29/78, ...]");
        range_Rational_Rational_helper("-1", "5/3",
                "[-1, 5/3, 1/3, -1/9, 7/9, -1/3, 1, -7/15, 1/15, 3/5, 17/15, -5/9, 11/9, -13/21, -5/21, 1/7, 11/21," +
                " 19/21, 9/7, -2/3, 0, 2/3, 4/3, -19/27, -11/27, 5/27, 13/27, 29/27, 37/27, -11/15, -1/5, 13/15," +
                " 7/5, -25/33, -17/33, -3/11, -1/33, 7/33, 5/11, 23/33, 31/33, 13/11, 47/33, -7/9, 1/9, 5/9, 13/9," +
                " -31/39, -23/39, -5/13, ...]");
    }

    @Test
    public void testFinitelyBoundedIntervals() {
        simpleProviderHelper(QEP.finitelyBoundedIntervals(),
                "[[0, 0], [0, 1], [1, 1], [1/2, 1], [0, 1/2], [0, 1/3], [1/3, 1], [1/4, 1], [1/2, 1/2], [1/3, 1/2]," +
                " [1/3, 1/3], [1/4, 1/3], [1/4, 1/2], [-1, 1/2], [-1, 1/3], [-1/2, 1/3], [0, 1/4], [-1, 0], [-1, 1]," +
                " [-1/2, 1], [-1/2, 0], [0, 2], [1, 2], [-1/3, 1], [-1/2, 1/2], [1/2, 2], [1/3, 2], [-1/3, 1/3]," +
                " [-1/3, 1/2], [-1/4, 1/2], [-1/4, 1/3], [1/3, 2/3], [1/4, 1/4], [-1, 1/4], [-1, -1], [-1, -1/2]," +
                " [-1/2, 1/4], [1/4, 2], [-1, 2], [-1, -1/3], [-1/2, -1/2], [-1/2, 2], [2, 2], [-1/3, 2]," +
                " [-1/2, -1/3], [-1/2, -1/4], [-1/4, 2], [2/3, 2], [-1/3, 1/4], [-1/4, 1/4], ...]");
    }

    @Test
    public void testIntervals() {
        simpleProviderHelper(QEP.intervals(),
                "[(-Infinity, Infinity), (-Infinity, 0], [0, Infinity), [0, 0], (-Infinity, 1], (-Infinity, 1/2]," +
                " [0, 1], [0, 1/2], [1, Infinity), [1/2, Infinity), [1, 1], [1/2, 1], [1/2, 1/2], (-Infinity, 1/3]," +
                " (-Infinity, 1/4], [0, 1/3], [0, 1/4], (-Infinity, -1], (-Infinity, -1/2], [1/3, Infinity)," +
                " [1/4, Infinity), [1/3, 1], [1/3, 1/2], [1/4, 1], [1/4, 1/2], [-1, Infinity), [-1, 0]," +
                " [-1/2, Infinity), [-1/2, 0], [-1, 1], [-1, 1/2], [-1/2, 1], [-1/2, 1/2], [1/3, 1/3], [1/4, 1/3]," +
                " [1/4, 1/4], [-1, 1/3], [-1, 1/4], [-1/2, 1/3], [-1/2, 1/4], [-1, -1], [-1, -1/2], [-1/2, -1/2]," +
                " (-Infinity, 2], (-Infinity, -1/3], [0, 2], (-Infinity, -1/4], (-Infinity, 2/3], [0, 2/3], [1, 2]," +
                " ...]");
    }

    private static void rationalsIn_helper(@NotNull String a, @NotNull String output) {
        simpleProviderHelper(QEP.rationalsIn(Interval.read(a).get()), output);
    }

    @Test
    public void testRationalsIn() {
        rationalsIn_helper("[0, 0]", "[0]");
        rationalsIn_helper("[1, 1]", "[1]");
        rationalsIn_helper("(-Infinity, Infinity)",
                "[0, 1, 1/2, 1/3, 1/4, -1, -1/2, 2, -1/3, -1/4, 2/3, 1/5, 1/6, 1/7, 1/8, -1/5, -1/6, 2/5, -1/7," +
                " -1/8, 2/7, -2, 3, 3/2, -2/3, 3/4, -3, -3/2, 4, -3/4, 4/3, -2/5, 3/5, -2/7, 3/7, 3/8, -3/5, 4/5," +
                " -3/7, -3/8, 4/7, 1/9, 1/10, 1/11, 1/12, -1/9, -1/10, 2/9, -1/11, -1/12, ...]");
        rationalsIn_helper("[1, 4]",
                "[1, 4, 5/2, 2, 3, 7/4, 13/4, 8/5, 11/5, 14/5, 17/5, 3/2, 7/2, 10/7, 13/7, 16/7, 19/7, 22/7, 25/7," +
                " 11/8, 17/8, 23/8, 29/8, 4/3, 5/3, 7/3, 8/3, 10/3, 11/3, 13/10, 19/10, 31/10, 37/10, 14/11, 17/11," +
                " 20/11, 23/11, 26/11, 29/11, 32/11, 35/11, 38/11, 41/11, 5/4, 9/4, 11/4, 15/4, 16/13, 19/13, 22/13," +
                " ...]");
        rationalsIn_helper("(-Infinity, 1/2]",
                "[1/2, -1/2, 0, -3/2, 1/6, 1/4, -1/6, -5/2, -1, -7/2, -1/4, -5/6, 3/10, 1/3, 1/10, 5/14, 3/8, 3/14," +
                " -1/10, -3/10, 1/14, 1/8, -1/14, -9/2, -2, -11/2, -7/6, -3/4, -13/2, -3, -15/2, -11/6, -5/4, -13/6," +
                " -1/3, -7/10, -3/14, -1/8, -5/14, -9/10, -2/3, -11/10, -3/8, -9/14, 7/18, 2/5, 5/18, 9/22, 5/12," +
                " 7/22, ...]");
        rationalsIn_helper("[1/2, Infinity)",
                "[1/2, 3/2, 1, 5/2, 5/6, 3/4, 7/6, 7/2, 2, 9/2, 5/4, 11/6, 7/10, 2/3, 9/10, 9/14, 5/8, 11/14, 11/10," +
                " 13/10, 13/14, 7/8, 15/14, 11/2, 3, 13/2, 13/6, 7/4, 15/2, 4, 17/2, 17/6, 9/4, 19/6, 4/3, 17/10," +
                " 17/14, 9/8, 19/14, 19/10, 5/3, 21/10, 11/8, 23/14, 11/18, 3/5, 13/18, 13/22, 7/12, 15/22, ...]");
    }

    private static void rationalsNotIn_helper(@NotNull String a, @NotNull String output) {
        simpleProviderHelper(QEP.rationalsNotIn(Interval.read(a).get()), output);
    }

    @Test
    public void testRationalsNotIn() {
        rationalsNotIn_helper("[0, 0]",
                "[1, 1/2, 1/3, 1/4, -1, -1/2, 2, -1/3, -1/4, 2/3, 1/5, 1/6, 1/7, 1/8, -1/5, -1/6, 2/5, -1/7, -1/8," +
                " 2/7, -2, 3, 3/2, -2/3, 3/4, -3, -3/2, 4, -3/4, 4/3, -2/5, 3/5, -2/7, 3/7, 3/8, -3/5, 4/5, -3/7," +
                " -3/8, 4/7, 1/9, 1/10, 1/11, 1/12, -1/9, -1/10, 2/9, -1/11, -1/12, 2/11, ...]");
        rationalsNotIn_helper("[1, 1]",
                "[0, 1/2, 1/3, 1/4, -1, -1/2, 2, -1/3, -1/4, 2/3, 1/5, 1/6, 1/7, 1/8, -1/5, -1/6, 2/5, -1/7, -1/8," +
                " 2/7, -2, 3, 3/2, -2/3, 3/4, -3, -3/2, 4, -3/4, 4/3, -2/5, 3/5, -2/7, 3/7, 3/8, -3/5, 4/5, -3/7," +
                " -3/8, 4/7, 1/9, 1/10, 1/11, 1/12, -1/9, -1/10, 2/9, -1/11, -1/12, 2/11, ...]");
        rationalsNotIn_helper("(-Infinity, Infinity)", "[]");
        rationalsNotIn_helper("[1, 4]",
                "[0, 5, 1/2, 9/2, -1, 6, 2/3, 13/3, 3/4, 17/4, 1/3, 14/3, -2, 7, -1/2, 11/2, -3, 8, 1/4, 19/4, -1/3," +
                " 16/3, 4/5, 21/5, 5/6, 25/6, 3/5, 22/5, 6/7, 29/7, 7/8, 33/8, 5/7, 30/7, 2/5, 23/5, 1/5, 24/5, 4/7," +
                " 31/7, 5/8, 35/8, 3/7, 32/7, -4, 9, -3/2, 13/2, -5, 10, ...]");
        rationalsNotIn_helper("(-Infinity, 1/2]",
                "[3/2, 1, 5/2, 5/6, 3/4, 7/6, 7/2, 2, 9/2, 5/4, 11/6, 7/10, 2/3, 9/10, 9/14, 5/8, 11/14, 11/10," +
                " 13/10, 13/14, 7/8, 15/14, 11/2, 3, 13/2, 13/6, 7/4, 15/2, 4, 17/2, 17/6, 9/4, 19/6, 4/3, 17/10," +
                " 17/14, 9/8, 19/14, 19/10, 5/3, 21/10, 11/8, 23/14, 11/18, 3/5, 13/18, 13/22, 7/12, 15/22, 4/5," +
                " ...]");
        rationalsNotIn_helper("[1/2, Infinity)",
                "[-1/2, 0, -3/2, 1/6, 1/4, -1/6, -5/2, -1, -7/2, -1/4, -5/6, 3/10, 1/3, 1/10, 5/14, 3/8, 3/14," +
                " -1/10, -3/10, 1/14, 1/8, -1/14, -9/2, -2, -11/2, -7/6, -3/4, -13/2, -3, -15/2, -11/6, -5/4, -13/6," +
                " -1/3, -7/10, -3/14, -1/8, -5/14, -9/10, -2/3, -11/10, -3/8, -9/14, 7/18, 2/5, 5/18, 9/22, 5/12," +
                " 7/22, 1/5, ...]");
    }

    private static void vectors_int_helper(int dimension, @NotNull String output) {
        simpleProviderHelper(QEP.vectors(dimension), output);
    }

    private static void vectors_int_fail_helper(int dimension) {
        try {
            QEP.vectors(dimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testVectors_int() {
        vectors_int_helper(0, "[[]]");
        vectors_int_helper(1,
                "[[0], [1], [-1], [2], [-2], [3], [-3], [4], [-4], [5], [-5], [6], [-6], [7], [-7], [8], [-8], [9]," +
                " [-9], [10], [-10], [11], [-11], [12], [-12], [13], [-13], [14], [-14], [15], [-15], [16], [-16]," +
                " [17], [-17], [18], [-18], [19], [-19], [20], [-20], [21], [-21], [22], [-22], [23], [-23], [24]," +
                " [-24], [25], ...]");
        vectors_int_helper(2,
                "[[0, 0], [0, 1], [1, 0], [1, 1], [0, -1], [0, 2], [1, -1], [1, 2], [-1, 0], [-1, 1], [2, 0]," +
                " [2, 1], [-1, -1], [-1, 2], [2, -1], [2, 2], [0, -2], [0, 3], [1, -2], [1, 3], [0, -3], [0, 4]," +
                " [1, -3], [1, 4], [-1, -2], [-1, 3], [2, -2], [2, 3], [-1, -3], [-1, 4], [2, -3], [2, 4], [-2, 0]," +
                " [-2, 1], [3, 0], [3, 1], [-2, -1], [-2, 2], [3, -1], [3, 2], [-3, 0], [-3, 1], [4, 0], [4, 1]," +
                " [-3, -1], [-3, 2], [4, -1], [4, 2], [-2, -2], [-2, 3], ...]");
        vectors_int_helper(3,
                "[[0, 0, 0], [0, 0, 1], [0, 1, 0], [0, 1, 1], [1, 0, 0], [1, 0, 1], [1, 1, 0], [1, 1, 1]," +
                " [0, 0, -1], [0, 0, 2], [0, 1, -1], [0, 1, 2], [1, 0, -1], [1, 0, 2], [1, 1, -1], [1, 1, 2]," +
                " [0, -1, 0], [0, -1, 1], [0, 2, 0], [0, 2, 1], [1, -1, 0], [1, -1, 1], [1, 2, 0], [1, 2, 1]," +
                " [0, -1, -1], [0, -1, 2], [0, 2, -1], [0, 2, 2], [1, -1, -1], [1, -1, 2], [1, 2, -1], [1, 2, 2]," +
                " [-1, 0, 0], [-1, 0, 1], [-1, 1, 0], [-1, 1, 1], [2, 0, 0], [2, 0, 1], [2, 1, 0], [2, 1, 1]," +
                " [-1, 0, -1], [-1, 0, 2], [-1, 1, -1], [-1, 1, 2], [2, 0, -1], [2, 0, 2], [2, 1, -1], [2, 1, 2]," +
                " [-1, -1, 0], [-1, -1, 1], ...]");
        vectors_int_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 1, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 1, 1, 0, 0], [0, 0, 0, 0, 0, 1, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 1, 1, 0], [0, 0, 0, 0, 0, 1, 1, 1, 1, 1], [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 0, 0, 0, 1, 0], [0, 0, 0, 0, 1, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 0, 0], [0, 0, 0, 0, 1, 0, 0, 1, 0, 1], [0, 0, 0, 0, 1, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 1, 1], [0, 0, 0, 0, 1, 0, 1, 0, 0, 0], [0, 0, 0, 0, 1, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 1, 0, 1, 0, 1, 0], [0, 0, 0, 0, 1, 0, 1, 0, 1, 1], [0, 0, 0, 0, 1, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 1, 1, 0, 1], [0, 0, 0, 0, 1, 0, 1, 1, 1, 0], [0, 0, 0, 0, 1, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 1, 1, 0, 0, 0, 0], [0, 0, 0, 0, 1, 1, 0, 0, 0, 1], ...]");
        vectors_int_fail_helper(-1);
    }

    @Test
    public void testVectors() {
        simpleProviderHelper(QEP.vectors(),
                "[[], [0], [0, 0], [1], [0, 0, 0], [-1], [0, 1], [2], [0, 0, 0, 0], [-2], [1, 0], [3], [0, 0, 1]," +
                " [-3], [1, 1], [4], [0, 0, 0, 0, 0], [-4], [0, -1], [5], [0, 1, 0], [-5], [0, 2], [6]," +
                " [0, 0, 0, 1], [-6], [1, -1], [7], [0, 1, 1], [-7], [1, 2], [8], [0, 0, 0, 0, 0, 0], [-8], [-1, 0]," +
                " [9], [1, 0, 0], [-9], [-1, 1], [10], [0, 0, 1, 0], [-10], [2, 0], [11], [1, 0, 1], [-11], [2, 1]," +
                " [12], [0, 0, 0, 0, 1], [-12], ...]");
    }

    private static void vectorsAtLeast_helper(int minDimension, @NotNull String output) {
        simpleProviderHelper(QEP.vectorsAtLeast(minDimension), output);
    }

    private static void vectorsAtLeast_fail_helper(int minDimension) {
        try {
            QEP.vectorsAtLeast(minDimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testVectorsAtLeast() {
        vectorsAtLeast_helper(0,
                "[[], [0], [0, 0], [1], [0, 0, 0], [-1], [0, 1], [2], [0, 0, 0, 0], [-2], [1, 0], [3], [0, 0, 1]," +
                " [-3], [1, 1], [4], [0, 0, 0, 0, 0], [-4], [0, -1], [5], [0, 1, 0], [-5], [0, 2], [6]," +
                " [0, 0, 0, 1], [-6], [1, -1], [7], [0, 1, 1], [-7], [1, 2], [8], [0, 0, 0, 0, 0, 0], [-8], [-1, 0]," +
                " [9], [1, 0, 0], [-9], [-1, 1], [10], [0, 0, 1, 0], [-10], [2, 0], [11], [1, 0, 1], [-11], [2, 1]," +
                " [12], [0, 0, 0, 0, 1], [-12], ...]");
        vectorsAtLeast_helper(1,
                "[[0], [0, 0], [1], [0, 0, 0], [-1], [0, 1], [2], [0, 0, 0, 0], [-2], [1, 0], [3], [0, 0, 1], [-3]," +
                " [1, 1], [4], [0, 0, 0, 0, 0], [-4], [0, -1], [5], [0, 1, 0], [-5], [0, 2], [6], [0, 0, 0, 1]," +
                " [-6], [1, -1], [7], [0, 1, 1], [-7], [1, 2], [8], [0, 0, 0, 0, 0, 0], [-8], [-1, 0], [9]," +
                " [1, 0, 0], [-9], [-1, 1], [10], [0, 0, 1, 0], [-10], [2, 0], [11], [1, 0, 1], [-11], [2, 1], [12]," +
                " [0, 0, 0, 0, 1], [-12], [-1, -1], ...]");
        vectorsAtLeast_helper(2,
                "[[0, 0], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0], [0, -1]," +
                " [0, 1, 0], [0, 2], [0, 0, 0, 1], [1, -1], [0, 1, 1], [1, 2], [0, 0, 0, 0, 0, 0], [-1, 0]," +
                " [1, 0, 0], [-1, 1], [0, 0, 1, 0], [2, 0], [1, 0, 1], [2, 1], [0, 0, 0, 0, 1], [-1, -1], [1, 1, 0]," +
                " [-1, 2], [0, 0, 1, 1], [2, -1], [1, 1, 1], [2, 2], [0, 0, 0, 0, 0, 0, 0], [0, -2], [0, 0, -1]," +
                " [0, 3], [0, 1, 0, 0], [1, -2], [0, 0, 2], [1, 3], [0, 0, 0, 1, 0], [0, -3], [0, 1, -1], [0, 4]," +
                " [0, 1, 0, 1], [1, -3], [0, 1, 2], [1, 4], [0, 0, 0, 0, 0, 1], [-1, -2], [1, 0, -1], ...]");
        vectorsAtLeast_helper(3,
                "[[0, 0, 0], [0, 0, 0, 0], [0, 0, 1], [0, 0, 0, 0, 0], [0, 1, 0], [0, 0, 0, 1], [0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0], [1, 0, 1], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1]," +
                " [1, 1, 1], [0, 0, 0, 0, 0, 0, 0], [0, 0, -1], [0, 1, 0, 0], [0, 0, 2], [0, 0, 0, 1, 0]," +
                " [0, 1, -1], [0, 1, 0, 1], [0, 1, 2], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2]," +
                " [0, 0, 0, 1, 1], [1, 1, -1], [0, 1, 1, 1], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0], [0, -1, 0]," +
                " [1, 0, 0, 0], [0, -1, 1], [0, 0, 1, 0, 0], [0, 2, 0], [1, 0, 0, 1], [0, 2, 1], [0, 0, 0, 0, 1, 0]," +
                " [1, -1, 0], [1, 0, 1, 0], [1, -1, 1], [0, 0, 1, 0, 1], [1, 2, 0], [1, 0, 1, 1], [1, 2, 1]," +
                " [0, 0, 0, 0, 0, 0, 1], [0, -1, -1], [1, 1, 0, 0], ...]");
        vectorsAtLeast_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0], ...]");
        vectorsAtLeast_fail_helper(-1);
    }

    private static void rationalVectors_int_helper(int dimension, @NotNull String output) {
        simpleProviderHelper(QEP.rationalVectors(dimension), output);
    }

    private static void rationalVectors_int_fail_helper(int dimension) {
        try {
            QEP.rationalVectors(dimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testRationalVectors_int() {
        rationalVectors_int_helper(0, "[[]]");
        rationalVectors_int_helper(1,
                "[[0], [1], [1/2], [1/3], [1/4], [-1], [-1/2], [2], [-1/3], [-1/4], [2/3], [1/5], [1/6], [1/7]," +
                " [1/8], [-1/5], [-1/6], [2/5], [-1/7], [-1/8], [2/7], [-2], [3], [3/2], [-2/3], [3/4], [-3]," +
                " [-3/2], [4], [-3/4], [4/3], [-2/5], [3/5], [-2/7], [3/7], [3/8], [-3/5], [4/5], [-3/7], [-3/8]," +
                " [4/7], [1/9], [1/10], [1/11], [1/12], [-1/9], [-1/10], [2/9], [-1/11], [-1/12], ...]");
        rationalVectors_int_helper(2,
                "[[0, 0], [0, 1], [1, 0], [1, 1], [0, 1/2], [0, 1/3], [1, 1/2], [1, 1/3], [1/2, 0], [1/2, 1]," +
                " [1/3, 0], [1/3, 1], [1/2, 1/2], [1/2, 1/3], [1/3, 1/2], [1/3, 1/3], [0, 1/4], [0, -1], [1, 1/4]," +
                " [1, -1], [0, -1/2], [0, 2], [1, -1/2], [1, 2], [1/2, 1/4], [1/2, -1], [1/3, 1/4], [1/3, -1]," +
                " [1/2, -1/2], [1/2, 2], [1/3, -1/2], [1/3, 2], [1/4, 0], [1/4, 1], [-1, 0], [-1, 1], [1/4, 1/2]," +
                " [1/4, 1/3], [-1, 1/2], [-1, 1/3], [-1/2, 0], [-1/2, 1], [2, 0], [2, 1], [-1/2, 1/2], [-1/2, 1/3]," +
                " [2, 1/2], [2, 1/3], [1/4, 1/4], [1/4, -1], ...]");
        rationalVectors_int_helper(3,
                "[[0, 0, 0], [0, 0, 1], [0, 1, 0], [0, 1, 1], [1, 0, 0], [1, 0, 1], [1, 1, 0], [1, 1, 1]," +
                " [0, 0, 1/2], [0, 0, 1/3], [0, 1, 1/2], [0, 1, 1/3], [1, 0, 1/2], [1, 0, 1/3], [1, 1, 1/2]," +
                " [1, 1, 1/3], [0, 1/2, 0], [0, 1/2, 1], [0, 1/3, 0], [0, 1/3, 1], [1, 1/2, 0], [1, 1/2, 1]," +
                " [1, 1/3, 0], [1, 1/3, 1], [0, 1/2, 1/2], [0, 1/2, 1/3], [0, 1/3, 1/2], [0, 1/3, 1/3]," +
                " [1, 1/2, 1/2], [1, 1/2, 1/3], [1, 1/3, 1/2], [1, 1/3, 1/3], [1/2, 0, 0], [1/2, 0, 1], [1/2, 1, 0]," +
                " [1/2, 1, 1], [1/3, 0, 0], [1/3, 0, 1], [1/3, 1, 0], [1/3, 1, 1], [1/2, 0, 1/2], [1/2, 0, 1/3]," +
                " [1/2, 1, 1/2], [1/2, 1, 1/3], [1/3, 0, 1/2], [1/3, 0, 1/3], [1/3, 1, 1/2], [1/3, 1, 1/3]," +
                " [1/2, 1/2, 0], [1/2, 1/2, 1], ...]");
        rationalVectors_int_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 1, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 1, 1, 0, 0], [0, 0, 0, 0, 0, 1, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 1, 1, 0], [0, 0, 0, 0, 0, 1, 1, 1, 1, 1], [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 0, 0, 0, 1, 0], [0, 0, 0, 0, 1, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 0, 0], [0, 0, 0, 0, 1, 0, 0, 1, 0, 1], [0, 0, 0, 0, 1, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 1, 1], [0, 0, 0, 0, 1, 0, 1, 0, 0, 0], [0, 0, 0, 0, 1, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 1, 0, 1, 0, 1, 0], [0, 0, 0, 0, 1, 0, 1, 0, 1, 1], [0, 0, 0, 0, 1, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 1, 1, 0, 1], [0, 0, 0, 0, 1, 0, 1, 1, 1, 0], [0, 0, 0, 0, 1, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 1, 1, 0, 0, 0, 0], [0, 0, 0, 0, 1, 1, 0, 0, 0, 1], ...]");
        rationalVectors_int_fail_helper(-1);
    }

    @Test
    public void testRationalVectors() {
        simpleProviderHelper(QEP.rationalVectors(),
                "[[], [0], [0, 0], [1], [0, 0, 0], [1/2], [0, 1], [1/3], [0, 0, 0, 0], [1/4], [1, 0], [-1]," +
                " [0, 0, 1], [-1/2], [1, 1], [2], [0, 0, 0, 0, 0], [-1/3], [0, 1/2], [-1/4], [0, 1, 0], [2/3]," +
                " [0, 1/3], [1/5], [0, 0, 0, 1], [1/6], [1, 1/2], [1/7], [0, 1, 1], [1/8], [1, 1/3], [-1/5]," +
                " [0, 0, 0, 0, 0, 0], [-1/6], [1/2, 0], [2/5], [1, 0, 0], [-1/7], [1/2, 1], [-1/8], [0, 0, 1, 0]," +
                " [2/7], [1/3, 0], [-2], [1, 0, 1], [3], [1/3, 1], [3/2], [0, 0, 0, 0, 1], [-2/3], ...]");
    }

    private static void rationalVectorsAtLeast_helper(int minDimension, @NotNull String output) {
        simpleProviderHelper(QEP.rationalVectorsAtLeast(minDimension), output);
    }

    private static void rationalVectorsAtLeast_fail_helper(int minDimension) {
        try {
            QEP.rationalVectorsAtLeast(minDimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testRationalVectorsAtLeast() {
        rationalVectorsAtLeast_helper(0,
                "[[], [0], [0, 0], [1], [0, 0, 0], [1/2], [0, 1], [1/3], [0, 0, 0, 0], [1/4], [1, 0], [-1]," +
                " [0, 0, 1], [-1/2], [1, 1], [2], [0, 0, 0, 0, 0], [-1/3], [0, 1/2], [-1/4], [0, 1, 0], [2/3]," +
                " [0, 1/3], [1/5], [0, 0, 0, 1], [1/6], [1, 1/2], [1/7], [0, 1, 1], [1/8], [1, 1/3], [-1/5]," +
                " [0, 0, 0, 0, 0, 0], [-1/6], [1/2, 0], [2/5], [1, 0, 0], [-1/7], [1/2, 1], [-1/8], [0, 0, 1, 0]," +
                " [2/7], [1/3, 0], [-2], [1, 0, 1], [3], [1/3, 1], [3/2], [0, 0, 0, 0, 1], [-2/3], ...]");
        rationalVectorsAtLeast_helper(1,
                "[[0], [0, 0], [1], [0, 0, 0], [1/2], [0, 1], [1/3], [0, 0, 0, 0], [1/4], [1, 0], [-1], [0, 0, 1]," +
                " [-1/2], [1, 1], [2], [0, 0, 0, 0, 0], [-1/3], [0, 1/2], [-1/4], [0, 1, 0], [2/3], [0, 1/3], [1/5]," +
                " [0, 0, 0, 1], [1/6], [1, 1/2], [1/7], [0, 1, 1], [1/8], [1, 1/3], [-1/5], [0, 0, 0, 0, 0, 0]," +
                " [-1/6], [1/2, 0], [2/5], [1, 0, 0], [-1/7], [1/2, 1], [-1/8], [0, 0, 1, 0], [2/7], [1/3, 0], [-2]," +
                " [1, 0, 1], [3], [1/3, 1], [3/2], [0, 0, 0, 0, 1], [-2/3], [1/2, 1/2], ...]");
        rationalVectorsAtLeast_helper(2,
                "[[0, 0], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0], [0, 1/2]," +
                " [0, 1, 0], [0, 1/3], [0, 0, 0, 1], [1, 1/2], [0, 1, 1], [1, 1/3], [0, 0, 0, 0, 0, 0], [1/2, 0]," +
                " [1, 0, 0], [1/2, 1], [0, 0, 1, 0], [1/3, 0], [1, 0, 1], [1/3, 1], [0, 0, 0, 0, 1], [1/2, 1/2]," +
                " [1, 1, 0], [1/2, 1/3], [0, 0, 1, 1], [1/3, 1/2], [1, 1, 1], [1/3, 1/3], [0, 0, 0, 0, 0, 0, 0]," +
                " [0, 1/4], [0, 0, 1/2], [0, -1], [0, 1, 0, 0], [1, 1/4], [0, 0, 1/3], [1, -1], [0, 0, 0, 1, 0]," +
                " [0, -1/2], [0, 1, 1/2], [0, 2], [0, 1, 0, 1], [1, -1/2], [0, 1, 1/3], [1, 2], [0, 0, 0, 0, 0, 1]," +
                " [1/2, 1/4], [1, 0, 1/2], ...]");
        rationalVectorsAtLeast_helper(3,
                "[[0, 0, 0], [0, 0, 0, 0], [0, 0, 1], [0, 0, 0, 0, 0], [0, 1, 0], [0, 0, 0, 1], [0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0], [1, 0, 1], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1]," +
                " [1, 1, 1], [0, 0, 0, 0, 0, 0, 0], [0, 0, 1/2], [0, 1, 0, 0], [0, 0, 1/3], [0, 0, 0, 1, 0]," +
                " [0, 1, 1/2], [0, 1, 0, 1], [0, 1, 1/3], [0, 0, 0, 0, 0, 1], [1, 0, 1/2], [0, 1, 1, 0]," +
                " [1, 0, 1/3], [0, 0, 0, 1, 1], [1, 1, 1/2], [0, 1, 1, 1], [1, 1, 1/3], [0, 0, 0, 0, 0, 0, 0, 0]," +
                " [0, 1/2, 0], [1, 0, 0, 0], [0, 1/2, 1], [0, 0, 1, 0, 0], [0, 1/3, 0], [1, 0, 0, 1], [0, 1/3, 1]," +
                " [0, 0, 0, 0, 1, 0], [1, 1/2, 0], [1, 0, 1, 0], [1, 1/2, 1], [0, 0, 1, 0, 1], [1, 1/3, 0]," +
                " [1, 0, 1, 1], [1, 1/3, 1], [0, 0, 0, 0, 0, 0, 1], [0, 1/2, 1/2], [1, 1, 0, 0], ...]");
        rationalVectorsAtLeast_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0], ...]");
        rationalVectorsAtLeast_fail_helper(-1);
    }

    private static void reducedRationalVectors_int_helper(int dimension, @NotNull String output) {
        simpleProviderHelper(QEP.reducedRationalVectors(dimension), output);
    }

    private static void reducedRationalVectors_int_fail_helper(int dimension) {
        try {
            QEP.reducedRationalVectors(dimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testReducedRationalVectors_int() {
        reducedRationalVectors_int_helper(0, "[[]]");
        reducedRationalVectors_int_helper(1, "[[0], [1]]");
        reducedRationalVectors_int_helper(2,
                "[[0, 0], [0, 1], [1, 0], [1, 1], [1, -1], [1, 2], [1, 1/2], [1, -1/2], [1, -2], [1, 3], [1, -3]," +
                " [1, 4], [1, 3/2], [1, -3/2], [1, 1/3], [1, -1/3], [1, 2/3], [1, 1/4], [1, -1/4], [1, -2/3]," +
                " [1, 4/3], [1, 3/4], [1, -3/4], [1, -4], [1, 5], [1, -5], [1, 6], [1, 5/2], [1, -5/2], [1, -6]," +
                " [1, 7], [1, -7], [1, 8], [1, 7/2], [1, -7/2], [1, -4/3], [1, 5/3], [1, -5/3], [1, 5/4], [1, -5/4]," +
                " [1, 7/3], [1, -7/3], [1, 8/3], [1, 7/4], [1, -7/4], [1, 1/5], [1, -1/5], [1, 2/5], [1, 1/6]," +
                " [1, -1/6], ...]");
        reducedRationalVectors_int_helper(3,
                "[[0, 0, 0], [0, 0, 1], [0, 1, 0], [0, 1, 1], [1, 0, 0], [1, 0, 1], [1, 1, 0], [1, 1, 1]," +
                " [0, 1, -1], [0, 1, 2], [1, 0, -1], [1, 0, 2], [1, 1, -1], [1, 1, 2], [0, 1, 1/2], [1, -1, 0]," +
                " [1, -1, 1], [1, 2, 0], [1, 2, 1], [0, 1, -1/2], [1, -1, -1], [1, -1, 2], [1, 2, -1], [1, 2, 2]," +
                " [1, 0, 1/2], [1, 1/2, 0], [1, 1/2, 1/2], [1, 0, -1/2], [1, 1/2, -1/2], [1, 1/2, 1], [1, -1/2, 0]," +
                " [1, -1/2, 1/2], [1, 1, 1/2], [1, -1/2, -1/2], [1, -1/2, 1], [1, 1, -1/2], [0, 1, -2], [0, 1, 3]," +
                " [1, 0, -2], [1, 0, 3], [1, 1, -2], [1, 1, 3], [0, 1, -3], [0, 1, 4], [1, 0, -3], [1, 0, 4]," +
                " [1, 1, -3], [1, 1, 4], [0, 1, 3/2], [1, -1, -2], ...]");
        reducedRationalVectors_int_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 1, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 1, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 1, 1, 0, 0], [0, 0, 0, 0, 0, 1, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 1, 1, 1, 1, 0], [0, 0, 0, 0, 0, 1, 1, 1, 1, 1], [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 0, 0, 0, 1, 0], [0, 0, 0, 0, 1, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 0, 0], [0, 0, 0, 0, 1, 0, 0, 1, 0, 1], [0, 0, 0, 0, 1, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 1, 0, 0, 1, 1, 1], [0, 0, 0, 0, 1, 0, 1, 0, 0, 0], [0, 0, 0, 0, 1, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 1, 0, 1, 0, 1, 0], [0, 0, 0, 0, 1, 0, 1, 0, 1, 1], [0, 0, 0, 0, 1, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 1, 0, 1, 1, 0, 1], [0, 0, 0, 0, 1, 0, 1, 1, 1, 0], [0, 0, 0, 0, 1, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 1, 1, 0, 0, 0, 0], [0, 0, 0, 0, 1, 1, 0, 0, 0, 1], ...]");
        reducedRationalVectors_int_fail_helper(-1);
    }

    @Test
    public void testReducedRationalVectors() {
        simpleProviderHelper(QEP.reducedRationalVectors(),
                "[[], [0], [0, 0], [1], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0]," +
                " [0, 1, 0], [0, 0, 0, 1], [1, -1], [0, 1, 1], [1, 2], [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0]," +
                " [1, 0, 1], [1, 1/2], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1], [1, -1/2], [1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 0], [1, -2], [1, 3], [0, 0, 0, 1, 0], [0, 1, -1], [0, 1, 0, 1]," +
                " [1, -3], [0, 1, 2], [1, 4], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2], [1, 3/2]," +
                " [0, 0, 0, 1, 1], [1, 1, -1], [0, 1, 1, 1], [1, -3/2], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0]," +
                " [1, 0, 0, 0], [1, 1/3], [0, 0, 1, 0, 0], ...]");
    }

    private static void reducedRationalVectorsAtLeast_helper(int minDimension, @NotNull String output) {
        simpleProviderHelper(QEP.reducedRationalVectorsAtLeast(minDimension), output);
    }

    private static void reducedRationalVectorsAtLeast_fail_helper(int minDimension) {
        try {
            QEP.reducedRationalVectorsAtLeast(minDimension);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testReducedRationalVectorsAtLeast() {
        reducedRationalVectorsAtLeast_helper(0,
                "[[], [0], [0, 0], [1], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0]," +
                " [0, 1, 0], [0, 0, 0, 1], [1, -1], [0, 1, 1], [1, 2], [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0]," +
                " [1, 0, 1], [1, 1/2], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1], [1, -1/2], [1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 0], [1, -2], [1, 3], [0, 0, 0, 1, 0], [0, 1, -1], [0, 1, 0, 1]," +
                " [1, -3], [0, 1, 2], [1, 4], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2], [1, 3/2]," +
                " [0, 0, 0, 1, 1], [1, 1, -1], [0, 1, 1, 1], [1, -3/2], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0]," +
                " [1, 0, 0, 0], [1, 1/3], [0, 0, 1, 0, 0], ...]");
        reducedRationalVectorsAtLeast_helper(1,
                "[[0], [0, 0], [1], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0]," +
                " [0, 1, 0], [0, 0, 0, 1], [1, -1], [0, 1, 1], [1, 2], [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0]," +
                " [1, 0, 1], [1, 1/2], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1], [1, -1/2], [1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 0], [1, -2], [1, 3], [0, 0, 0, 1, 0], [0, 1, -1], [0, 1, 0, 1]," +
                " [1, -3], [0, 1, 2], [1, 4], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2], [1, 3/2]," +
                " [0, 0, 0, 1, 1], [1, 1, -1], [0, 1, 1, 1], [1, -3/2], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0]," +
                " [1, 0, 0, 0], [1, 1/3], [0, 0, 1, 0, 0], [1, 0, 0, 1], ...]");
        reducedRationalVectorsAtLeast_helper(2,
                "[[0, 0], [0, 0, 0], [0, 1], [0, 0, 0, 0], [1, 0], [0, 0, 1], [1, 1], [0, 0, 0, 0, 0], [0, 1, 0]," +
                " [0, 0, 0, 1], [1, -1], [0, 1, 1], [1, 2], [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0], [1, 0, 1]," +
                " [1, 1/2], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1], [1, -1/2], [1, 1, 1], [0, 0, 0, 0, 0, 0, 0]," +
                " [0, 1, 0, 0], [1, -2], [1, 3], [0, 0, 0, 1, 0], [0, 1, -1], [0, 1, 0, 1], [1, -3], [0, 1, 2]," +
                " [1, 4], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2], [1, 3/2], [0, 0, 0, 1, 1]," +
                " [1, 1, -1], [0, 1, 1, 1], [1, -3/2], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0], [1, 1/3]," +
                " [0, 0, 1, 0, 0], [1, 0, 0, 1], [1, -1/3], [0, 1, 1/2], ...]");
        reducedRationalVectorsAtLeast_helper(3,
                "[[0, 0, 0], [0, 0, 0, 0], [0, 0, 1], [0, 0, 0, 0, 0], [0, 1, 0], [0, 0, 0, 1], [0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0], [1, 0, 0], [0, 0, 1, 0], [1, 0, 1], [0, 0, 0, 0, 1], [1, 1, 0], [0, 0, 1, 1]," +
                " [1, 1, 1], [0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 1, -1], [0, 1, 0, 1]," +
                " [0, 1, 2], [0, 0, 0, 0, 0, 1], [1, 0, -1], [0, 1, 1, 0], [1, 0, 2], [0, 0, 0, 1, 1], [1, 1, -1]," +
                " [0, 1, 1, 1], [1, 1, 2], [0, 0, 0, 0, 0, 0, 0, 0], [1, 0, 0, 0], [0, 0, 1, 0, 0], [1, 0, 0, 1]," +
                " [0, 1, 1/2], [0, 0, 0, 0, 1, 0], [1, -1, 0], [1, 0, 1, 0], [1, -1, 1], [0, 0, 1, 0, 1], [1, 2, 0]," +
                " [1, 0, 1, 1], [1, 2, 1], [0, 0, 0, 0, 0, 0, 1], [1, 1, 0, 0], [0, 0, 1, 1, 0], [0, 1, -1/2]," +
                " [1, 1, 0, 1], [0, 0, 0, 0, 1, 1], [1, -1, -1], [1, 1, 1, 0], ...]");
        reducedRationalVectorsAtLeast_helper(10,
                "[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 1, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 0, 1, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 1, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0, 1, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1], [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1], [0, 0, 0, 0, 0, 1, 0, 0, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 1, 0, 1, 0, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1], [0, 0, 0, 0, 0, 1, 0, 1, 1, 1]," +
                " [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0], ...]");
        reducedRationalVectorsAtLeast_fail_helper(-1);
    }

    private static void matrices_int_int_helper(int height, int width, @NotNull String output) {
        simpleProviderHelper(QEP.matrices(height, width), output);
    }

    private static void matrices_int_int_fail_helper(int height, int width) {
        try {
            QEP.matrices(height, width);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testMatrices_int_int() {
        matrices_int_int_helper(0, 0, "[[]#0]");
        matrices_int_int_helper(0, 3, "[[]#3]");
        matrices_int_int_helper(3, 0, "[[[], [], []]]");
        matrices_int_int_helper(1, 1,
                "[[[0]], [[1]], [[-1]], [[2]], [[-2]], [[3]], [[-3]], [[4]], [[-4]], [[5]], [[-5]], [[6]], [[-6]]," +
                " [[7]], [[-7]], [[8]], [[-8]], [[9]], [[-9]], [[10]], [[-10]], [[11]], [[-11]], [[12]], [[-12]]," +
                " [[13]], [[-13]], [[14]], [[-14]], [[15]], [[-15]], [[16]], [[-16]], [[17]], [[-17]], [[18]]," +
                " [[-18]], [[19]], [[-19]], [[20]], [[-20]], [[21]], [[-21]], [[22]], [[-22]], [[23]], [[-23]]," +
                " [[24]], [[-24]], [[25]], ...]");
        matrices_int_int_helper(2, 2,
                "[[[0, 0], [0, 0]], [[0, 0], [0, 1]], [[0, 1], [0, 0]], [[0, 1], [0, 1]], [[0, 0], [1, 0]]," +
                " [[0, 0], [1, 1]], [[0, 1], [1, 0]], [[0, 1], [1, 1]], [[1, 0], [0, 0]], [[1, 0], [0, 1]]," +
                " [[1, 1], [0, 0]], [[1, 1], [0, 1]], [[1, 0], [1, 0]], [[1, 0], [1, 1]], [[1, 1], [1, 0]]," +
                " [[1, 1], [1, 1]], [[0, 0], [0, -1]], [[0, 0], [0, 2]], [[0, 1], [0, -1]], [[0, 1], [0, 2]]," +
                " [[0, 0], [1, -1]], [[0, 0], [1, 2]], [[0, 1], [1, -1]], [[0, 1], [1, 2]], [[1, 0], [0, -1]]," +
                " [[1, 0], [0, 2]], [[1, 1], [0, -1]], [[1, 1], [0, 2]], [[1, 0], [1, -1]], [[1, 0], [1, 2]]," +
                " [[1, 1], [1, -1]], [[1, 1], [1, 2]], [[0, -1], [0, 0]], [[0, -1], [0, 1]], [[0, 2], [0, 0]]," +
                " [[0, 2], [0, 1]], [[0, -1], [1, 0]], [[0, -1], [1, 1]], [[0, 2], [1, 0]], [[0, 2], [1, 1]]," +
                " [[1, -1], [0, 0]], [[1, -1], [0, 1]], [[1, 2], [0, 0]], [[1, 2], [0, 1]], [[1, -1], [1, 0]]," +
                " [[1, -1], [1, 1]], [[1, 2], [1, 0]], [[1, 2], [1, 1]], [[0, -1], [0, -1]], [[0, -1], [0, 2]], ...]");
        matrices_int_int_helper(3, 4,
                "[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 0, 1]], ...]");
        matrices_int_int_fail_helper(-1, 0);
        matrices_int_int_fail_helper(-1, 1);
        matrices_int_int_fail_helper(0, -1);
        matrices_int_int_fail_helper(1, -1);
        matrices_int_int_fail_helper(-1, -1);
    }

    @Test
    public void testMatrices() {
        simpleProviderHelper(QEP.matrices(),
                "[[[0]], []#0, [[]], [[0, 0]], []#1, [[1]], [[0, 1]], [[-1]], [[], []], [[1, 0]], [[2]], [[1, 1]]," +
                " [[0], [0]], [[0, 0], [0, 0]], [[0], [1]], [[0, 0], [0, 1]], []#2, [[1], [0]], [[0, 1], [0, 0]]," +
                " [[1], [1]], [[0, 1], [0, 1]], [[-2]], [[0, -1]], [[3]], [[0, 2]], [[-3]], [[1, -1]], [[4]]," +
                " [[1, 2]], [[0], [-1]], [[0, 0], [1, 0]], [[0], [2]], [[], [], []], [[0, 0], [1, 1]], [[1], [-1]]," +
                " [[0, 1], [1, 0]], [[1], [2]], [[0, 1], [1, 1]], [[-4]], [[-1, 0]], [[5]], [[-1, 1]], [[-5]]," +
                " [[2, 0]], [[6]], [[2, 1]], [[-1], [0]], [[1, 0], [0, 0]], [[-1], [1]], [[1, 0], [0, 1]], ...]");
    }

    @Test
    public void testSquareMatrices() {
        simpleProviderHelper(QEP.squareMatrices(),
                "[[]#0, [[0]], [[0, 0], [0, 0]], [[1]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[-1]], [[0, 0], [0, 1]]," +
                " [[2]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[-2]], [[0, 1], [0, 0]], [[3]]," +
                " [[0, 0, 0], [0, 0, 0], [0, 0, 1]], [[-3]], [[0, 1], [0, 1]], [[4]]," +
                " [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]], [[-4]]," +
                " [[0, 0], [1, 0]], [[5]], [[0, 0, 0], [0, 0, 1], [0, 0, 0]], [[-5]], [[0, 0], [1, 1]], [[6]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]], [[-6]], [[0, 1], [1, 0]], [[7]]," +
                " [[0, 0, 0], [0, 0, 1], [0, 0, 1]], [[-7]], [[0, 1], [1, 1]], [[8]]," +
                " [[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]], [[-8]], [[1, 0], [0, 0]], [[9]]," +
                " [[0, 0, 1], [0, 0, 0], [0, 0, 0]], [[-9]], [[1, 0], [0, 1]], [[10]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[-10]], [[1, 1], [0, 0]], [[11]]," +
                " [[0, 0, 1], [0, 0, 0], [0, 0, 1]], [[-11]], [[1, 1], [0, 1]], [[12]]," +
                " [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 1]]," +
                " [[-12]], ...]");
    }

    private static void rationalMatrices_int_int_helper(int height, int width, @NotNull String output) {
        simpleProviderHelper(QEP.rationalMatrices(height, width), output);
    }

    private static void rationalMatrices_int_int_fail_helper(int height, int width) {
        try {
            QEP.rationalMatrices(height, width);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testRationalMatrices_int_int() {
        rationalMatrices_int_int_helper(0, 0, "[[]#0]");
        rationalMatrices_int_int_helper(0, 3, "[[]#3]");
        rationalMatrices_int_int_helper(3, 0, "[[[], [], []]]");
        rationalMatrices_int_int_helper(1, 1,
                "[[[0]], [[1]], [[1/2]], [[1/3]], [[1/4]], [[-1]], [[-1/2]], [[2]], [[-1/3]], [[-1/4]], [[2/3]]," +
                " [[1/5]], [[1/6]], [[1/7]], [[1/8]], [[-1/5]], [[-1/6]], [[2/5]], [[-1/7]], [[-1/8]], [[2/7]]," +
                " [[-2]], [[3]], [[3/2]], [[-2/3]], [[3/4]], [[-3]], [[-3/2]], [[4]], [[-3/4]], [[4/3]], [[-2/5]]," +
                " [[3/5]], [[-2/7]], [[3/7]], [[3/8]], [[-3/5]], [[4/5]], [[-3/7]], [[-3/8]], [[4/7]], [[1/9]]," +
                " [[1/10]], [[1/11]], [[1/12]], [[-1/9]], [[-1/10]], [[2/9]], [[-1/11]], [[-1/12]], ...]");
        rationalMatrices_int_int_helper(2, 2,
                "[[[0, 0], [0, 0]], [[0, 0], [0, 1]], [[0, 1], [0, 0]], [[0, 1], [0, 1]], [[0, 0], [1, 0]]," +
                " [[0, 0], [1, 1]], [[0, 1], [1, 0]], [[0, 1], [1, 1]], [[1, 0], [0, 0]], [[1, 0], [0, 1]]," +
                " [[1, 1], [0, 0]], [[1, 1], [0, 1]], [[1, 0], [1, 0]], [[1, 0], [1, 1]], [[1, 1], [1, 0]]," +
                " [[1, 1], [1, 1]], [[0, 0], [0, 1/2]], [[0, 0], [0, 1/3]], [[0, 1], [0, 1/2]], [[0, 1], [0, 1/3]]," +
                " [[0, 0], [1, 1/2]], [[0, 0], [1, 1/3]], [[0, 1], [1, 1/2]], [[0, 1], [1, 1/3]]," +
                " [[1, 0], [0, 1/2]], [[1, 0], [0, 1/3]], [[1, 1], [0, 1/2]], [[1, 1], [0, 1/3]]," +
                " [[1, 0], [1, 1/2]], [[1, 0], [1, 1/3]], [[1, 1], [1, 1/2]], [[1, 1], [1, 1/3]]," +
                " [[0, 1/2], [0, 0]], [[0, 1/2], [0, 1]], [[0, 1/3], [0, 0]], [[0, 1/3], [0, 1]]," +
                " [[0, 1/2], [1, 0]], [[0, 1/2], [1, 1]], [[0, 1/3], [1, 0]], [[0, 1/3], [1, 1]]," +
                " [[1, 1/2], [0, 0]], [[1, 1/2], [0, 1]], [[1, 1/3], [0, 0]], [[1, 1/3], [0, 1]]," +
                " [[1, 1/2], [1, 0]], [[1, 1/2], [1, 1]], [[1, 1/3], [1, 0]], [[1, 1/3], [1, 1]]," +
                " [[0, 1/2], [0, 1/2]], [[0, 1/2], [0, 1/3]], ...]");
        rationalMatrices_int_int_helper(3, 4,
                "[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 0, 0]], [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 0]], [[0, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 1, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 1, 0]], [[0, 0, 0, 1], [0, 0, 1, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 0, 0]], [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 0, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 1, 0], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 1, 0], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 1, 0]], [[0, 0, 1, 1], [0, 0, 0, 0], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 1, 0]], [[0, 0, 1, 1], [0, 0, 0, 1], [0, 0, 1, 1]]," +
                " [[0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 0, 0]], [[0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 0, 1]], ...]");
        rationalMatrices_int_int_fail_helper(-1, 0);
        rationalMatrices_int_int_fail_helper(-1, 1);
        rationalMatrices_int_int_fail_helper(0, -1);
        rationalMatrices_int_int_fail_helper(1, -1);
        rationalMatrices_int_int_fail_helper(-1, -1);
    }

    @Test
    public void testRationalMatrices() {
        simpleProviderHelper(QEP.rationalMatrices(),
                "[[[0]], []#0, [[]], [[0, 0]], []#1, [[1]], [[0, 1]], [[1/2]], [[], []], [[1, 0]], [[1/3]]," +
                " [[1, 1]], [[0], [0]], [[0, 0], [0, 0]], [[0], [1]], [[0, 0], [0, 1]], []#2, [[1], [0]]," +
                " [[0, 1], [0, 0]], [[1], [1]], [[0, 1], [0, 1]], [[1/4]], [[0, 1/2]], [[-1]], [[0, 1/3]]," +
                " [[-1/2]], [[1, 1/2]], [[2]], [[1, 1/3]], [[0], [1/2]], [[0, 0], [1, 0]], [[0], [1/3]]," +
                " [[], [], []], [[0, 0], [1, 1]], [[1], [1/2]], [[0, 1], [1, 0]], [[1], [1/3]], [[0, 1], [1, 1]]," +
                " [[-1/3]], [[1/2, 0]], [[-1/4]], [[1/2, 1]], [[2/3]], [[1/3, 0]], [[1/5]], [[1/3, 1]]," +
                " [[1/2], [0]], [[1, 0], [0, 0]], [[1/2], [1]], [[1, 0], [0, 1]], ...]");
    }

    @Test
    public void testSquareRationalMatrices() {
        simpleProviderHelper(QEP.squareRationalMatrices(),
                "[[]#0, [[0]], [[0, 0], [0, 0]], [[1]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[1/2]]," +
                " [[0, 0], [0, 1]], [[1/3]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[1/4]]," +
                " [[0, 1], [0, 0]], [[-1]], [[0, 0, 0], [0, 0, 0], [0, 0, 1]], [[-1/2]], [[0, 1], [0, 1]], [[2]]," +
                " [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]], [[-1/3]]," +
                " [[0, 0], [1, 0]], [[-1/4]], [[0, 0, 0], [0, 0, 1], [0, 0, 0]], [[2/3]], [[0, 0], [1, 1]], [[1/5]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]], [[1/6]], [[0, 1], [1, 0]], [[1/7]]," +
                " [[0, 0, 0], [0, 0, 1], [0, 0, 1]], [[1/8]], [[0, 1], [1, 1]], [[-1/5]]," +
                " [[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]," +
                " [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]], [[-1/6]], [[1, 0], [0, 0]], [[2/5]]," +
                " [[0, 0, 1], [0, 0, 0], [0, 0, 0]], [[-1/7]], [[1, 0], [0, 1]], [[-1/8]]," +
                " [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0]], [[2/7]], [[1, 1], [0, 0]], [[-2]]," +
                " [[0, 0, 1], [0, 0, 0], [0, 0, 1]], [[3]], [[1, 1], [0, 1]], [[3/2]]," +
                " [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 1]], [[-2/3]]," +
                " ...]");
    }

    private static void polynomials_int_helper(int degree, @NotNull String output) {
        simpleProviderHelper(QEP.polynomials(degree), output);
    }

    private static void polynomials_int_fail_helper(int degree) {
        try {
            QEP.polynomials(degree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPolynomials_int() {
        polynomials_int_helper(-1, "[0]");
        polynomials_int_helper(0,
                "[1, -1, 2, -2, 3, -3, 4, -4, 5, -5, 6, -6, 7, -7, 8, -8, 9, -9, 10, -10, 11, -11, 12, -12, 13, -13," +
                " 14, -14, 15, -15, 16, -16, 17, -17, 18, -18, 19, -19, 20, -20, 21, -21, 22, -22, 23, -23, 24, -24," +
                " 25, -25, ...]");
        polynomials_int_helper(1,
                "[x, x+1, -x, 2*x, -x+1, 2*x+1, x-1, x+2, -x-1, 2*x-1, -x+2, 2*x+2, -2*x, 3*x, -2*x+1, 3*x+1, -3*x," +
                " 4*x, -3*x+1, 4*x+1, -2*x-1, 3*x-1, -2*x+2, 3*x+2, -3*x-1, 4*x-1, -3*x+2, 4*x+2, x-2, x+3, -x-2," +
                " 2*x-2, -x+3, 2*x+3, x-3, x+4, -x-3, 2*x-3, -x+4, 2*x+4, -2*x-2, 3*x-2, -2*x+3, 3*x+3, -3*x-2," +
                " 4*x-2, -3*x+3, 4*x+3, -2*x-3, 3*x-3, ...]");
        polynomials_int_helper(2,
                "[x^2, x^2+x, x^2+1, x^2+x+1, -x^2, 2*x^2, -x^2+x, 2*x^2+x, -x^2+1, 2*x^2+1, -x^2+x+1, 2*x^2+x+1," +
                " x^2-x, x^2+2*x, x^2-x+1, x^2+2*x+1, -x^2-x, 2*x^2-x, -x^2+2*x, 2*x^2+2*x, -x^2-x+1, 2*x^2-x+1," +
                " -x^2+2*x+1, 2*x^2+2*x+1, x^2-1, x^2+x-1, x^2+2, x^2+x+2, -x^2-1, 2*x^2-1, -x^2+x-1, 2*x^2+x-1," +
                " -x^2+2, 2*x^2+2, -x^2+x+2, 2*x^2+x+2, x^2-x-1, x^2+2*x-1, x^2-x+2, x^2+2*x+2, -x^2-x-1, 2*x^2-x-1," +
                " -x^2+2*x-1, 2*x^2+2*x-1, -x^2-x+2, 2*x^2-x+2, -x^2+2*x+2, 2*x^2+2*x+2, -2*x^2, 3*x^2, ...]");
        polynomials_int_helper(9,
                "[x^9, x^9+x^8, x^9+x^7, x^9+x^8+x^7, x^9+x^6, x^9+x^8+x^6, x^9+x^7+x^6, x^9+x^8+x^7+x^6, x^9+x^5," +
                " x^9+x^8+x^5, x^9+x^7+x^5, x^9+x^8+x^7+x^5, x^9+x^6+x^5, x^9+x^8+x^6+x^5, x^9+x^7+x^6+x^5," +
                " x^9+x^8+x^7+x^6+x^5, x^9+x^4, x^9+x^8+x^4, x^9+x^7+x^4, x^9+x^8+x^7+x^4, x^9+x^6+x^4," +
                " x^9+x^8+x^6+x^4, x^9+x^7+x^6+x^4, x^9+x^8+x^7+x^6+x^4, x^9+x^5+x^4, x^9+x^8+x^5+x^4," +
                " x^9+x^7+x^5+x^4, x^9+x^8+x^7+x^5+x^4, x^9+x^6+x^5+x^4, x^9+x^8+x^6+x^5+x^4, x^9+x^7+x^6+x^5+x^4," +
                " x^9+x^8+x^7+x^6+x^5+x^4, x^9+x^3, x^9+x^8+x^3, x^9+x^7+x^3, x^9+x^8+x^7+x^3, x^9+x^6+x^3," +
                " x^9+x^8+x^6+x^3, x^9+x^7+x^6+x^3, x^9+x^8+x^7+x^6+x^3, x^9+x^5+x^3, x^9+x^8+x^5+x^3," +
                " x^9+x^7+x^5+x^3, x^9+x^8+x^7+x^5+x^3, x^9+x^6+x^5+x^3, x^9+x^8+x^6+x^5+x^3, x^9+x^7+x^6+x^5+x^3," +
                " x^9+x^8+x^7+x^6+x^5+x^3, x^9+x^4+x^3, x^9+x^8+x^4+x^3, ...]");
        polynomials_int_fail_helper(-2);
    }

    @Test
    public void testPolynomials() {
        simpleProviderHelper(QEP.polynomials(),
                "[0, 1, -1, x, 2, -2, 3, x^2, -3, x+1, 4, -4, -x, 5, -5, 2*x, 6, x^3, -6, -x+1, 7, x^2+x, -7, 2*x+1," +
                " 8, -8, 9, -9, x-1, 10, -10, 11, x^2+1, -11, x+2, 12, x^4, -12, -x-1, 13, -13, 2*x-1, 14, x^3+x^2," +
                " -14, -x+2, 15, x^2+x+1, -15, 2*x+2, ...]");
    }

    private static void polynomialsAtLeast_helper(int minDegree, @NotNull String output) {
        simpleProviderHelper(QEP.polynomialsAtLeast(minDegree), output);
    }

    private static void polynomialsAtLeast_fail_helper(int minDegree) {
        try {
            QEP.polynomialsAtLeast(minDegree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPolynomialsAtLeast() {
        polynomialsAtLeast_helper(-1,
                "[0, 1, -1, x, 2, -2, 3, x^2, -3, x+1, 4, -4, -x, 5, -5, 2*x, 6, x^3, -6, -x+1, 7, x^2+x, -7, 2*x+1," +
                " 8, -8, 9, -9, x-1, 10, -10, 11, x^2+1, -11, x+2, 12, x^4, -12, -x-1, 13, -13, 2*x-1, 14, x^3+x^2," +
                " -14, -x+2, 15, x^2+x+1, -15, 2*x+2, ...]");
        polynomialsAtLeast_helper(0,
                "[1, -1, x, 2, -2, 3, x^2, -3, x+1, 4, -4, -x, 5, -5, 2*x, 6, x^3, -6, -x+1, 7, x^2+x, -7, 2*x+1, 8," +
                " -8, 9, -9, x-1, 10, -10, 11, x^2+1, -11, x+2, 12, x^4, -12, -x-1, 13, -13, 2*x-1, 14, x^3+x^2," +
                " -14, -x+2, 15, x^2+x+1, -15, 2*x+2, 16, ...]");
        polynomialsAtLeast_helper(1,
                "[x, x^2, x+1, -x, 2*x, x^3, -x+1, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, -x-1, 2*x-1, x^3+x^2, -x+2," +
                " x^2+x+1, 2*x+2, -2*x, -x^2, 3*x, -2*x+1, 2*x^2, 3*x+1, -3*x, -x^2+x, 4*x, x^3+x, -3*x+1, 2*x^2+x," +
                " 4*x+1, x^5, -2*x-1, -x^2+1, 3*x-1, -2*x+2, 2*x^2+1, 3*x+2, x^4+x^3, -3*x-1, -x^2+x+1, 4*x-1," +
                " x^3+x^2+x, -3*x+2, 2*x^2+x+1, 4*x+2, x-2, x^2-x, x+3, ...]");
        polynomialsAtLeast_helper(2,
                "[x^2, x^3, x^2+x, x^2+1, x^4, x^3+x^2, x^2+x+1, -x^2, 2*x^2, -x^2+x, x^3+x, 2*x^2+x, x^5, -x^2+1," +
                " 2*x^2+1, x^4+x^3, -x^2+x+1, x^3+x^2+x, 2*x^2+x+1, x^2-x, x^3+1, x^2+2*x, x^2-x+1, x^4+x^2," +
                " x^3+x^2+1, x^2+2*x+1, x^6, -x^2-x, 2*x^2-x, -x^2+2*x, x^3+x+1, 2*x^2+2*x, x^5+x^4, -x^2-x+1," +
                " 2*x^2-x+1, x^4+x^3+x^2, -x^2+2*x+1, x^3+x^2+x+1, 2*x^2+2*x+1, -x^3, x^2-1, 2*x^3, x^2+x-1," +
                " -x^3+x^2, x^2+2, x^4+x, 2*x^3+x^2, x^2+x+2, -x^2-1, -x^3+x, ...]");
        polynomialsAtLeast_helper(9,
                "[x^9, x^10, x^9+x^8, x^9+x^7, x^11, x^10+x^9, x^9+x^8+x^7, x^9+x^6, x^10+x^8, x^9+x^8+x^6, x^12," +
                " x^9+x^7+x^6, x^11+x^10, x^10+x^9+x^8, x^9+x^8+x^7+x^6, x^9+x^5, x^10+x^7, x^9+x^8+x^5," +
                " x^9+x^7+x^5, x^11+x^9, x^10+x^9+x^7, x^9+x^8+x^7+x^5, x^13, x^9+x^6+x^5, x^10+x^8+x^7," +
                " x^9+x^8+x^6+x^5, x^12+x^11, x^9+x^7+x^6+x^5, x^11+x^10+x^9, x^10+x^9+x^8+x^7, x^9+x^8+x^7+x^6+x^5," +
                " x^9+x^4, x^10+x^6, x^9+x^8+x^4, x^9+x^7+x^4, x^11+x^8, x^10+x^9+x^6, x^9+x^8+x^7+x^4, x^9+x^6+x^4," +
                " x^10+x^8+x^6, x^9+x^8+x^6+x^4, x^12+x^10, x^9+x^7+x^6+x^4, x^11+x^10+x^8, x^10+x^9+x^8+x^6," +
                " x^9+x^8+x^7+x^6+x^4, x^14, x^9+x^5+x^4, x^10+x^7+x^6, x^9+x^8+x^5+x^4, ...]");
        polynomialsAtLeast_fail_helper(-2);
    }

    private static void primitivePolynomials_int_helper(int degree, @NotNull String output) {
        simpleProviderHelper(QEP.primitivePolynomials(degree), output);
    }

    private static void primitivePolynomials_int_fail_helper(int degree) {
        try {
            QEP.primitivePolynomials(degree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPrimitivePolynomials_int() {
        primitivePolynomials_int_helper(-1, "[]");
        primitivePolynomials_int_helper(0, "[1, -1]");
        primitivePolynomials_int_helper(1,
                "[x, x+1, -x, -x+1, 2*x+1, x-1, x+2, -x-1, 2*x-1, -x+2, -2*x+1, 3*x+1, -3*x+1, 4*x+1, -2*x-1, 3*x-1," +
                " 3*x+2, -3*x-1, 4*x-1, -3*x+2, x-2, x+3, -x-2, -x+3, 2*x+3, x-3, x+4, -x-3, 2*x-3, -x+4, 3*x-2," +
                " -2*x+3, -3*x-2, 4*x+3, -2*x-3, 3*x+4, 4*x-3, -3*x+4, -4*x+1, 5*x+1, -5*x+1, 6*x+1, -4*x-1, 5*x-1," +
                " 5*x+2, -5*x-1, 6*x-1, -5*x+2, -6*x+1, 7*x+1, ...]");
        primitivePolynomials_int_helper(2,
                "[x^2, x^2+x, x^2+1, x^2+x+1, -x^2, -x^2+x, 2*x^2+x, -x^2+1, 2*x^2+1, -x^2+x+1, 2*x^2+x+1, x^2-x," +
                " x^2+2*x, x^2-x+1, x^2+2*x+1, -x^2-x, 2*x^2-x, -x^2+2*x, -x^2-x+1, 2*x^2-x+1, -x^2+2*x+1," +
                " 2*x^2+2*x+1, x^2-1, x^2+x-1, x^2+2, x^2+x+2, -x^2-1, 2*x^2-1, -x^2+x-1, 2*x^2+x-1, -x^2+2," +
                " -x^2+x+2, 2*x^2+x+2, x^2-x-1, x^2+2*x-1, x^2-x+2, x^2+2*x+2, -x^2-x-1, 2*x^2-x-1, -x^2+2*x-1," +
                " 2*x^2+2*x-1, -x^2-x+2, 2*x^2-x+2, -x^2+2*x+2, -2*x^2+x, 3*x^2+x, -2*x^2+1, 3*x^2+1, -2*x^2+x+1," +
                " 3*x^2+x+1, ...]");
        primitivePolynomials_int_helper(8,
                "[x^8, x^8+x^7, x^8+x^6, x^8+x^7+x^6, x^8+x^5, x^8+x^7+x^5, x^8+x^6+x^5, x^8+x^7+x^6+x^5, x^8+x^4," +
                " x^8+x^7+x^4, x^8+x^6+x^4, x^8+x^7+x^6+x^4, x^8+x^5+x^4, x^8+x^7+x^5+x^4, x^8+x^6+x^5+x^4," +
                " x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^8+x^7+x^3, x^8+x^6+x^3, x^8+x^7+x^6+x^3, x^8+x^5+x^3," +
                " x^8+x^7+x^5+x^3, x^8+x^6+x^5+x^3, x^8+x^7+x^6+x^5+x^3, x^8+x^4+x^3, x^8+x^7+x^4+x^3," +
                " x^8+x^6+x^4+x^3, x^8+x^7+x^6+x^4+x^3, x^8+x^5+x^4+x^3, x^8+x^7+x^5+x^4+x^3, x^8+x^6+x^5+x^4+x^3," +
                " x^8+x^7+x^6+x^5+x^4+x^3, x^8+x^2, x^8+x^7+x^2, x^8+x^6+x^2, x^8+x^7+x^6+x^2, x^8+x^5+x^2," +
                " x^8+x^7+x^5+x^2, x^8+x^6+x^5+x^2, x^8+x^7+x^6+x^5+x^2, x^8+x^4+x^2, x^8+x^7+x^4+x^2," +
                " x^8+x^6+x^4+x^2, x^8+x^7+x^6+x^4+x^2, x^8+x^5+x^4+x^2, x^8+x^7+x^5+x^4+x^2, x^8+x^6+x^5+x^4+x^2," +
                " x^8+x^7+x^6+x^5+x^4+x^2, x^8+x^3+x^2, x^8+x^7+x^3+x^2, ...]");
        primitivePolynomials_int_fail_helper(-2);
    }

    @Test
    public void testPrimitivePolynomials() {
        simpleProviderHelper(QEP.primitivePolynomials(),
                "[1, -1, x, x^2, x+1, -x, x^3, -x+1, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, -x-1, 2*x-1, x^3+x^2, -x+2," +
                " x^2+x+1, -x^2, -2*x+1, 3*x+1, -x^2+x, x^3+x, -3*x+1, 2*x^2+x, 4*x+1, x^5, -2*x-1, -x^2+1, 3*x-1," +
                " 2*x^2+1, 3*x+2, x^4+x^3, -3*x-1, -x^2+x+1, 4*x-1, x^3+x^2+x, -3*x+2, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " -x-2, x^3+1, -x+3, x^2+2*x, 2*x+3, x-3, x^2-x+1, ...]");
    }

    private static void primitivePolynomialsAtLeast_helper(int minDegree, @NotNull String output) {
        simpleProviderHelper(QEP.primitivePolynomialsAtLeast(minDegree), output);
    }

    private static void primitivePolynomialsAtLeast_fail_helper(int minDegree) {
        try {
            QEP.primitivePolynomialsAtLeast(minDegree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPrimitivePolynomialsAtLeast() {
        primitivePolynomialsAtLeast_helper(-1,
                "[1, -1, x, x^2, x+1, -x, x^3, -x+1, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, -x-1, 2*x-1, x^3+x^2, -x+2," +
                " x^2+x+1, -x^2, -2*x+1, 3*x+1, -x^2+x, x^3+x, -3*x+1, 2*x^2+x, 4*x+1, x^5, -2*x-1, -x^2+1, 3*x-1," +
                " 2*x^2+1, 3*x+2, x^4+x^3, -3*x-1, -x^2+x+1, 4*x-1, x^3+x^2+x, -3*x+2, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " -x-2, x^3+1, -x+3, x^2+2*x, 2*x+3, x-3, x^2-x+1, ...]");
        primitivePolynomialsAtLeast_helper(0,
                "[1, -1, x, x^2, x+1, -x, x^3, -x+1, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, -x-1, 2*x-1, x^3+x^2, -x+2," +
                " x^2+x+1, -x^2, -2*x+1, 3*x+1, -x^2+x, x^3+x, -3*x+1, 2*x^2+x, 4*x+1, x^5, -2*x-1, -x^2+1, 3*x-1," +
                " 2*x^2+1, 3*x+2, x^4+x^3, -3*x-1, -x^2+x+1, 4*x-1, x^3+x^2+x, -3*x+2, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " -x-2, x^3+1, -x+3, x^2+2*x, 2*x+3, x-3, x^2-x+1, ...]");
        primitivePolynomialsAtLeast_helper(1,
                "[x, x^2, x+1, -x, x^3, -x+1, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, -x-1, 2*x-1, x^3+x^2, -x+2," +
                " x^2+x+1, -x^2, -2*x+1, 3*x+1, -x^2+x, x^3+x, -3*x+1, 2*x^2+x, 4*x+1, x^5, -2*x-1, -x^2+1, 3*x-1," +
                " 2*x^2+1, 3*x+2, x^4+x^3, -3*x-1, -x^2+x+1, 4*x-1, x^3+x^2+x, -3*x+2, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " -x-2, x^3+1, -x+3, x^2+2*x, 2*x+3, x-3, x^2-x+1, x+4, x^4+x^2, ...]");
        primitivePolynomialsAtLeast_helper(2,
                "[x^2, x^3, x^2+x, x^2+1, x^4, x^3+x^2, x^2+x+1, -x^2, -x^2+x, x^3+x, 2*x^2+x, x^5, -x^2+1, 2*x^2+1," +
                " x^4+x^3, -x^2+x+1, x^3+x^2+x, 2*x^2+x+1, x^2-x, x^3+1, x^2+2*x, x^2-x+1, x^4+x^2, x^3+x^2+1," +
                " x^2+2*x+1, x^6, -x^2-x, 2*x^2-x, -x^2+2*x, x^3+x+1, x^5+x^4, -x^2-x+1, 2*x^2-x+1, x^4+x^3+x^2," +
                " -x^2+2*x+1, x^3+x^2+x+1, 2*x^2+2*x+1, -x^3, x^2-1, x^2+x-1, -x^3+x^2, x^2+2, x^4+x, 2*x^3+x^2," +
                " x^2+x+2, -x^2-1, -x^3+x, 2*x^2-1, -x^2+x-1, 2*x^3+x, ...]");
        primitivePolynomialsAtLeast_helper(8,
                "[x^8, x^9, x^8+x^7, x^8+x^6, x^10, x^9+x^8, x^8+x^7+x^6, x^8+x^5, x^9+x^7, x^8+x^7+x^5, x^11," +
                " x^8+x^6+x^5, x^10+x^9, x^9+x^8+x^7, x^8+x^7+x^6+x^5, x^8+x^4, x^9+x^6, x^8+x^7+x^4, x^8+x^6+x^4," +
                " x^10+x^8, x^9+x^8+x^6, x^8+x^7+x^6+x^4, x^12, x^8+x^5+x^4, x^9+x^7+x^6, x^8+x^7+x^5+x^4," +
                " x^11+x^10, x^8+x^6+x^5+x^4, x^10+x^9+x^8, x^9+x^8+x^7+x^6, x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^9+x^5," +
                " x^8+x^7+x^3, x^8+x^6+x^3, x^10+x^7, x^9+x^8+x^5, x^8+x^7+x^6+x^3, x^8+x^5+x^3, x^9+x^7+x^5," +
                " x^8+x^7+x^5+x^3, x^11+x^9, x^8+x^6+x^5+x^3, x^10+x^9+x^7, x^9+x^8+x^7+x^5, x^8+x^7+x^6+x^5+x^3," +
                " x^13, x^8+x^4+x^3, x^9+x^6+x^5, x^8+x^7+x^4+x^3, ...]");
        primitivePolynomialsAtLeast_fail_helper(-2);
    }

    private static void positivePrimitivePolynomials_int_helper(int degree, @NotNull String output) {
        simpleProviderHelper(QEP.positivePrimitivePolynomials(degree), output);
    }

    private static void positivePrimitivePolynomials_int_fail_helper(int degree) {
        try {
            QEP.positivePrimitivePolynomials(degree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPositivePrimitivePolynomials_int() {
        positivePrimitivePolynomials_int_helper(-1, "[]");
        positivePrimitivePolynomials_int_helper(0, "[1]");
        positivePrimitivePolynomials_int_helper(1,
                "[x, x+1, 2*x+1, x-1, x+2, 2*x-1, 3*x+1, 4*x+1, 3*x-1, 3*x+2, 4*x-1, x-2, x+3, 2*x+3, x-3, x+4," +
                " 2*x-3, 3*x-2, 4*x+3, 3*x+4, 4*x-3, 5*x+1, 6*x+1, 5*x-1, 5*x+2, 6*x-1, 7*x+1, 8*x+1, 7*x-1, 7*x+2," +
                " 8*x-1, 5*x-2, 5*x+3, 5*x-3, 5*x+4, 7*x-2, 7*x+3, 8*x+3, 7*x-3, 7*x+4, 8*x-3, x-4, x+5, 2*x+5, x-5," +
                " x+6, 2*x-5, 3*x-4, 3*x+5, 4*x+5, ...]");
        positivePrimitivePolynomials_int_helper(2,
                "[x^2, x^2+x, x^2+1, x^2+x+1, 2*x^2+x, 2*x^2+1, 2*x^2+x+1, x^2-x, x^2+2*x, x^2-x+1, x^2+2*x+1," +
                " 2*x^2-x, 2*x^2-x+1, 2*x^2+2*x+1, x^2-1, x^2+x-1, x^2+2, x^2+x+2, 2*x^2-1, 2*x^2+x-1, 2*x^2+x+2," +
                " x^2-x-1, x^2+2*x-1, x^2-x+2, x^2+2*x+2, 2*x^2-x-1, 2*x^2+2*x-1, 2*x^2-x+2, 3*x^2+x, 3*x^2+1," +
                " 3*x^2+x+1, 4*x^2+x, 4*x^2+1, 4*x^2+x+1, 3*x^2-x, 3*x^2+2*x, 3*x^2-x+1, 3*x^2+2*x+1, 4*x^2-x," +
                " 4*x^2-x+1, 4*x^2+2*x+1, 3*x^2-1, 3*x^2+x-1, 3*x^2+2, 3*x^2+x+2, 4*x^2-1, 4*x^2+x-1, 4*x^2+x+2," +
                " 3*x^2-x-1, 3*x^2+2*x-1, ...]");
        positivePrimitivePolynomials_int_helper(8,
                "[x^8, x^8+x^7, x^8+x^6, x^8+x^7+x^6, x^8+x^5, x^8+x^7+x^5, x^8+x^6+x^5, x^8+x^7+x^6+x^5, x^8+x^4," +
                " x^8+x^7+x^4, x^8+x^6+x^4, x^8+x^7+x^6+x^4, x^8+x^5+x^4, x^8+x^7+x^5+x^4, x^8+x^6+x^5+x^4," +
                " x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^8+x^7+x^3, x^8+x^6+x^3, x^8+x^7+x^6+x^3, x^8+x^5+x^3," +
                " x^8+x^7+x^5+x^3, x^8+x^6+x^5+x^3, x^8+x^7+x^6+x^5+x^3, x^8+x^4+x^3, x^8+x^7+x^4+x^3," +
                " x^8+x^6+x^4+x^3, x^8+x^7+x^6+x^4+x^3, x^8+x^5+x^4+x^3, x^8+x^7+x^5+x^4+x^3, x^8+x^6+x^5+x^4+x^3," +
                " x^8+x^7+x^6+x^5+x^4+x^3, x^8+x^2, x^8+x^7+x^2, x^8+x^6+x^2, x^8+x^7+x^6+x^2, x^8+x^5+x^2," +
                " x^8+x^7+x^5+x^2, x^8+x^6+x^5+x^2, x^8+x^7+x^6+x^5+x^2, x^8+x^4+x^2, x^8+x^7+x^4+x^2," +
                " x^8+x^6+x^4+x^2, x^8+x^7+x^6+x^4+x^2, x^8+x^5+x^4+x^2, x^8+x^7+x^5+x^4+x^2, x^8+x^6+x^5+x^4+x^2," +
                " x^8+x^7+x^6+x^5+x^4+x^2, x^8+x^3+x^2, x^8+x^7+x^3+x^2, ...]");
        positivePrimitivePolynomials_int_fail_helper(-2);
    }

    @Test
    public void testPositivePrimitivePolynomials() {
        simpleProviderHelper(QEP.positivePrimitivePolynomials(),
                "[1, x, x^2, x+1, x^3, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, 2*x-1, x^3+x^2, x^2+x+1, 3*x+1, x^3+x," +
                " 2*x^2+x, 4*x+1, x^5, 3*x-1, 2*x^2+1, 3*x+2, x^4+x^3, 4*x-1, x^3+x^2+x, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " x^3+1, x^2+2*x, 2*x+3, x-3, x^2-x+1, x+4, x^4+x^2, 2*x-3, x^3+x^2+1, x^2+2*x+1, x^6, 3*x-2," +
                " 2*x^2-x, x^3+x+1, 4*x+3, x^5+x^4, 2*x^2-x+1, 3*x+4, x^4+x^3+x^2, 4*x-3, x^3+x^2+x+1, ...]");
    }

    private static void positivePrimitivePolynomialsAtLeast_helper(int minDegree, @NotNull String output) {
        simpleProviderHelper(QEP.positivePrimitivePolynomialsAtLeast(minDegree), output);
    }

    private static void positivePrimitivePolynomialsAtLeast_fail_helper(int minDegree) {
        try {
            QEP.positivePrimitivePolynomialsAtLeast(minDegree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testPositivePrimitivePolynomialsAtLeast() {
        positivePrimitivePolynomialsAtLeast_helper(-1,
                "[1, x, x^2, x+1, x^3, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, 2*x-1, x^3+x^2, x^2+x+1, 3*x+1, x^3+x," +
                " 2*x^2+x, 4*x+1, x^5, 3*x-1, 2*x^2+1, 3*x+2, x^4+x^3, 4*x-1, x^3+x^2+x, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " x^3+1, x^2+2*x, 2*x+3, x-3, x^2-x+1, x+4, x^4+x^2, 2*x-3, x^3+x^2+1, x^2+2*x+1, x^6, 3*x-2," +
                " 2*x^2-x, x^3+x+1, 4*x+3, x^5+x^4, 2*x^2-x+1, 3*x+4, x^4+x^3+x^2, 4*x-3, x^3+x^2+x+1, ...]");
        positivePrimitivePolynomialsAtLeast_helper(0,
                "[1, x, x^2, x+1, x^3, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, 2*x-1, x^3+x^2, x^2+x+1, 3*x+1, x^3+x," +
                " 2*x^2+x, 4*x+1, x^5, 3*x-1, 2*x^2+1, 3*x+2, x^4+x^3, 4*x-1, x^3+x^2+x, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " x^3+1, x^2+2*x, 2*x+3, x-3, x^2-x+1, x+4, x^4+x^2, 2*x-3, x^3+x^2+1, x^2+2*x+1, x^6, 3*x-2," +
                " 2*x^2-x, x^3+x+1, 4*x+3, x^5+x^4, 2*x^2-x+1, 3*x+4, x^4+x^3+x^2, 4*x-3, x^3+x^2+x+1, ...]");
        positivePrimitivePolynomialsAtLeast_helper(1,
                "[x, x^2, x+1, x^3, x^2+x, 2*x+1, x-1, x^2+1, x+2, x^4, 2*x-1, x^3+x^2, x^2+x+1, 3*x+1, x^3+x," +
                " 2*x^2+x, 4*x+1, x^5, 3*x-1, 2*x^2+1, 3*x+2, x^4+x^3, 4*x-1, x^3+x^2+x, 2*x^2+x+1, x-2, x^2-x, x+3," +
                " x^3+1, x^2+2*x, 2*x+3, x-3, x^2-x+1, x+4, x^4+x^2, 2*x-3, x^3+x^2+1, x^2+2*x+1, x^6, 3*x-2," +
                " 2*x^2-x, x^3+x+1, 4*x+3, x^5+x^4, 2*x^2-x+1, 3*x+4, x^4+x^3+x^2, 4*x-3, x^3+x^2+x+1, 2*x^2+2*x+1," +
                " ...]");
        positivePrimitivePolynomialsAtLeast_helper(2,
                "[x^2, x^3, x^2+x, x^2+1, x^4, x^3+x^2, x^2+x+1, x^3+x, 2*x^2+x, x^5, 2*x^2+1, x^4+x^3, x^3+x^2+x," +
                " 2*x^2+x+1, x^2-x, x^3+1, x^2+2*x, x^2-x+1, x^4+x^2, x^3+x^2+1, x^2+2*x+1, x^6, 2*x^2-x, x^3+x+1," +
                " x^5+x^4, 2*x^2-x+1, x^4+x^3+x^2, x^3+x^2+x+1, 2*x^2+2*x+1, x^2-1, x^2+x-1, x^2+2, x^4+x," +
                " 2*x^3+x^2, x^2+x+2, 2*x^2-1, 2*x^3+x, 2*x^2+x-1, x^5+x^3, x^4+x^3+x, 2*x^3+x^2+x, 2*x^2+x+2, x^7," +
                " x^2-x-1, 2*x^3+1, x^2+2*x-1, x^2-x+2, x^4+x^2+x, 2*x^3+x^2+1, x^2+2*x+2, ...]");
        positivePrimitivePolynomialsAtLeast_helper(8,
                "[x^8, x^9, x^8+x^7, x^8+x^6, x^10, x^9+x^8, x^8+x^7+x^6, x^8+x^5, x^9+x^7, x^8+x^7+x^5, x^11," +
                " x^8+x^6+x^5, x^10+x^9, x^9+x^8+x^7, x^8+x^7+x^6+x^5, x^8+x^4, x^9+x^6, x^8+x^7+x^4, x^8+x^6+x^4," +
                " x^10+x^8, x^9+x^8+x^6, x^8+x^7+x^6+x^4, x^12, x^8+x^5+x^4, x^9+x^7+x^6, x^8+x^7+x^5+x^4," +
                " x^11+x^10, x^8+x^6+x^5+x^4, x^10+x^9+x^8, x^9+x^8+x^7+x^6, x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^9+x^5," +
                " x^8+x^7+x^3, x^8+x^6+x^3, x^10+x^7, x^9+x^8+x^5, x^8+x^7+x^6+x^3, x^8+x^5+x^3, x^9+x^7+x^5," +
                " x^8+x^7+x^5+x^3, x^11+x^9, x^8+x^6+x^5+x^3, x^10+x^9+x^7, x^9+x^8+x^7+x^5, x^8+x^7+x^6+x^5+x^3," +
                " x^13, x^8+x^4+x^3, x^9+x^6+x^5, x^8+x^7+x^4+x^3, ...]");
        positivePrimitivePolynomialsAtLeast_fail_helper(-2);
    }

    private static void rationalPolynomials_int_helper(int degree, @NotNull String output) {
        simpleProviderHelper(QEP.rationalPolynomials(degree), output);
    }

    private static void rationalPolynomials_int_fail_helper(int degree) {
        try {
            QEP.rationalPolynomials(degree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testRationalPolynomials_int() {
        rationalPolynomials_int_helper(-1, "[0]");
        rationalPolynomials_int_helper(0,
                "[1, 1/2, 1/3, 1/4, -1, -1/2, 2, -1/3, -1/4, 2/3, 1/5, 1/6, 1/7, 1/8, -1/5, -1/6, 2/5, -1/7, -1/8," +
                " 2/7, -2, 3, 3/2, -2/3, 3/4, -3, -3/2, 4, -3/4, 4/3, -2/5, 3/5, -2/7, 3/7, 3/8, -3/5, 4/5, -3/7," +
                " -3/8, 4/7, 1/9, 1/10, 1/11, 1/12, -1/9, -1/10, 2/9, -1/11, -1/12, 2/11, ...]");
        rationalPolynomials_int_helper(1,
                "[x, x+1, 1/2*x, 1/3*x, 1/2*x+1, 1/3*x+1, x+1/2, x+1/3, 1/2*x+1/2, 1/3*x+1/2, 1/2*x+1/3, 1/3*x+1/3," +
                " 1/4*x, -x, 1/4*x+1, -x+1, -1/2*x, 2*x, -1/2*x+1, 2*x+1, 1/4*x+1/2, -x+1/2, 1/4*x+1/3, -x+1/3," +
                " -1/2*x+1/2, 2*x+1/2, -1/2*x+1/3, 2*x+1/3, x+1/4, x-1, 1/2*x+1/4, 1/3*x+1/4, 1/2*x-1, 1/3*x-1," +
                " x-1/2, x+2, 1/2*x-1/2, 1/3*x-1/2, 1/2*x+2, 1/3*x+2, 1/4*x+1/4, -x+1/4, 1/4*x-1, -x-1, -1/2*x+1/4," +
                " 2*x+1/4, -1/2*x-1, 2*x-1, 1/4*x-1/2, -x-1/2, ...]");
        rationalPolynomials_int_helper(2,
                "[x^2, x^2+x, x^2+1, x^2+x+1, 1/2*x^2, 1/3*x^2, 1/2*x^2+x, 1/3*x^2+x, 1/2*x^2+1, 1/3*x^2+1," +
                " 1/2*x^2+x+1, 1/3*x^2+x+1, x^2+1/2*x, x^2+1/3*x, x^2+1/2*x+1, x^2+1/3*x+1, 1/2*x^2+1/2*x," +
                " 1/3*x^2+1/2*x, 1/2*x^2+1/3*x, 1/3*x^2+1/3*x, 1/2*x^2+1/2*x+1, 1/3*x^2+1/2*x+1, 1/2*x^2+1/3*x+1," +
                " 1/3*x^2+1/3*x+1, x^2+1/2, x^2+x+1/2, x^2+1/3, x^2+x+1/3, 1/2*x^2+1/2, 1/3*x^2+1/2, 1/2*x^2+x+1/2," +
                " 1/3*x^2+x+1/2, 1/2*x^2+1/3, 1/3*x^2+1/3, 1/2*x^2+x+1/3, 1/3*x^2+x+1/3, x^2+1/2*x+1/2," +
                " x^2+1/3*x+1/2, x^2+1/2*x+1/3, x^2+1/3*x+1/3, 1/2*x^2+1/2*x+1/2, 1/3*x^2+1/2*x+1/2," +
                " 1/2*x^2+1/3*x+1/2, 1/3*x^2+1/3*x+1/2, 1/2*x^2+1/2*x+1/3, 1/3*x^2+1/2*x+1/3, 1/2*x^2+1/3*x+1/3," +
                " 1/3*x^2+1/3*x+1/3, 1/4*x^2, -x^2, ...]");
        rationalPolynomials_int_helper(9,
                "[x^9, x^9+x^8, x^9+x^7, x^9+x^8+x^7, x^9+x^6, x^9+x^8+x^6, x^9+x^7+x^6, x^9+x^8+x^7+x^6, x^9+x^5," +
                " x^9+x^8+x^5, x^9+x^7+x^5, x^9+x^8+x^7+x^5, x^9+x^6+x^5, x^9+x^8+x^6+x^5, x^9+x^7+x^6+x^5," +
                " x^9+x^8+x^7+x^6+x^5, x^9+x^4, x^9+x^8+x^4, x^9+x^7+x^4, x^9+x^8+x^7+x^4, x^9+x^6+x^4," +
                " x^9+x^8+x^6+x^4, x^9+x^7+x^6+x^4, x^9+x^8+x^7+x^6+x^4, x^9+x^5+x^4, x^9+x^8+x^5+x^4," +
                " x^9+x^7+x^5+x^4, x^9+x^8+x^7+x^5+x^4, x^9+x^6+x^5+x^4, x^9+x^8+x^6+x^5+x^4, x^9+x^7+x^6+x^5+x^4," +
                " x^9+x^8+x^7+x^6+x^5+x^4, x^9+x^3, x^9+x^8+x^3, x^9+x^7+x^3, x^9+x^8+x^7+x^3, x^9+x^6+x^3," +
                " x^9+x^8+x^6+x^3, x^9+x^7+x^6+x^3, x^9+x^8+x^7+x^6+x^3, x^9+x^5+x^3, x^9+x^8+x^5+x^3," +
                " x^9+x^7+x^5+x^3, x^9+x^8+x^7+x^5+x^3, x^9+x^6+x^5+x^3, x^9+x^8+x^6+x^5+x^3, x^9+x^7+x^6+x^5+x^3," +
                " x^9+x^8+x^7+x^6+x^5+x^3, x^9+x^4+x^3, x^9+x^8+x^4+x^3, ...]");
        rationalPolynomials_int_fail_helper(-2);
    }

    @Test
    public void testRationalPolynomials() {
        simpleProviderHelper(QEP.rationalPolynomials(),
                "[0, 1, 1/2, x, 1/3, 1/4, -1, x^2, -1/2, x+1, 2, -1/3, 1/2*x, -1/4, 2/3, 1/3*x, 1/5, x^3, 1/6," +
                " 1/2*x+1, 1/7, x^2+x, 1/8, 1/3*x+1, -1/5, -1/6, 2/5, -1/7, x+1/2, -1/8, 2/7, -2, x^2+1, 3, x+1/3," +
                " 3/2, x^4, -2/3, 1/2*x+1/2, 3/4, -3, 1/3*x+1/2, -3/2, x^3+x^2, 4, 1/2*x+1/3, -3/4, x^2+x+1, 4/3," +
                " 1/3*x+1/3, ...]");
    }

    private static void rationalPolynomialsAtLeast_helper(int minDegree, @NotNull String output) {
        simpleProviderHelper(QEP.rationalPolynomialsAtLeast(minDegree), output);
    }

    private static void rationalPolynomialsAtLeast_fail_helper(int minDegree) {
        try {
            QEP.rationalPolynomialsAtLeast(minDegree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testRationalPolynomialsAtLeast() {
        rationalPolynomialsAtLeast_helper(-1,
                "[0, 1, 1/2, x, 1/3, 1/4, -1, x^2, -1/2, x+1, 2, -1/3, 1/2*x, -1/4, 2/3, 1/3*x, 1/5, x^3, 1/6," +
                " 1/2*x+1, 1/7, x^2+x, 1/8, 1/3*x+1, -1/5, -1/6, 2/5, -1/7, x+1/2, -1/8, 2/7, -2, x^2+1, 3, x+1/3," +
                " 3/2, x^4, -2/3, 1/2*x+1/2, 3/4, -3, 1/3*x+1/2, -3/2, x^3+x^2, 4, 1/2*x+1/3, -3/4, x^2+x+1, 4/3," +
                " 1/3*x+1/3, ...]");
        rationalPolynomialsAtLeast_helper(0,
                "[1, 1/2, x, 1/3, 1/4, -1, x^2, -1/2, x+1, 2, -1/3, 1/2*x, -1/4, 2/3, 1/3*x, 1/5, x^3, 1/6, 1/2*x+1," +
                " 1/7, x^2+x, 1/8, 1/3*x+1, -1/5, -1/6, 2/5, -1/7, x+1/2, -1/8, 2/7, -2, x^2+1, 3, x+1/3, 3/2, x^4," +
                " -2/3, 1/2*x+1/2, 3/4, -3, 1/3*x+1/2, -3/2, x^3+x^2, 4, 1/2*x+1/3, -3/4, x^2+x+1, 4/3, 1/3*x+1/3," +
                " -2/5, ...]");
        rationalPolynomialsAtLeast_helper(1,
                "[x, x^2, x+1, 1/2*x, 1/3*x, x^3, 1/2*x+1, x^2+x, 1/3*x+1, x+1/2, x^2+1, x+1/3, x^4, 1/2*x+1/2," +
                " 1/3*x+1/2, x^3+x^2, 1/2*x+1/3, x^2+x+1, 1/3*x+1/3, 1/4*x, 1/2*x^2, -x, 1/4*x+1, 1/3*x^2, -x+1," +
                " -1/2*x, 1/2*x^2+x, 2*x, x^3+x, -1/2*x+1, 1/3*x^2+x, 2*x+1, x^5, 1/4*x+1/2, 1/2*x^2+1, -x+1/2," +
                " 1/4*x+1/3, 1/3*x^2+1, -x+1/3, x^4+x^3, -1/2*x+1/2, 1/2*x^2+x+1, 2*x+1/2, x^3+x^2+x, -1/2*x+1/3," +
                " 1/3*x^2+x+1, 2*x+1/3, x+1/4, x^2+1/2*x, x-1, ...]");
        rationalPolynomialsAtLeast_helper(2,
                "[x^2, x^3, x^2+x, x^2+1, x^4, x^3+x^2, x^2+x+1, 1/2*x^2, 1/3*x^2, 1/2*x^2+x, x^3+x, 1/3*x^2+x, x^5," +
                " 1/2*x^2+1, 1/3*x^2+1, x^4+x^3, 1/2*x^2+x+1, x^3+x^2+x, 1/3*x^2+x+1, x^2+1/2*x, x^3+1, x^2+1/3*x," +
                " x^2+1/2*x+1, x^4+x^2, x^3+x^2+1, x^2+1/3*x+1, x^6, 1/2*x^2+1/2*x, 1/3*x^2+1/2*x, 1/2*x^2+1/3*x," +
                " x^3+x+1, 1/3*x^2+1/3*x, x^5+x^4, 1/2*x^2+1/2*x+1, 1/3*x^2+1/2*x+1, x^4+x^3+x^2, 1/2*x^2+1/3*x+1," +
                " x^3+x^2+x+1, 1/3*x^2+1/3*x+1, 1/2*x^3, x^2+1/2, 1/3*x^3, x^2+x+1/2, 1/2*x^3+x^2, x^2+1/3, x^4+x," +
                " 1/3*x^3+x^2, x^2+x+1/3, 1/2*x^2+1/2, 1/2*x^3+x, ...]");
        rationalPolynomialsAtLeast_helper(9,
                "[x^9, x^10, x^9+x^8, x^9+x^7, x^11, x^10+x^9, x^9+x^8+x^7, x^9+x^6, x^10+x^8, x^9+x^8+x^6, x^12," +
                " x^9+x^7+x^6, x^11+x^10, x^10+x^9+x^8, x^9+x^8+x^7+x^6, x^9+x^5, x^10+x^7, x^9+x^8+x^5," +
                " x^9+x^7+x^5, x^11+x^9, x^10+x^9+x^7, x^9+x^8+x^7+x^5, x^13, x^9+x^6+x^5, x^10+x^8+x^7," +
                " x^9+x^8+x^6+x^5, x^12+x^11, x^9+x^7+x^6+x^5, x^11+x^10+x^9, x^10+x^9+x^8+x^7, x^9+x^8+x^7+x^6+x^5," +
                " x^9+x^4, x^10+x^6, x^9+x^8+x^4, x^9+x^7+x^4, x^11+x^8, x^10+x^9+x^6, x^9+x^8+x^7+x^4, x^9+x^6+x^4," +
                " x^10+x^8+x^6, x^9+x^8+x^6+x^4, x^12+x^10, x^9+x^7+x^6+x^4, x^11+x^10+x^8, x^10+x^9+x^8+x^6," +
                " x^9+x^8+x^7+x^6+x^4, x^14, x^9+x^5+x^4, x^10+x^7+x^6, x^9+x^8+x^5+x^4, ...]");
        rationalPolynomialsAtLeast_fail_helper(-2);
    }

    private static void monicRationalPolynomials_int_helper(int degree, @NotNull String output) {
        simpleProviderHelper(QEP.monicRationalPolynomials(degree), output);
    }

    private static void monicRationalPolynomials_int_fail_helper(int degree) {
        try {
            QEP.monicRationalPolynomials(degree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testMonicRationalPolynomials_int() {
        monicRationalPolynomials_int_helper(-1, "[]");
        monicRationalPolynomials_int_helper(0, "[1]");
        monicRationalPolynomials_int_helper(1,
                "[x, x+1, x+1/2, x-1, x+2, x-1/2, x+1/3, x+1/4, x-1/3, x+2/3, x-1/4, x-2, x+3, x+3/2, x-3, x+4," +
                " x-3/2, x-2/3, x+3/4, x+4/3, x-3/4, x+1/5, x+1/6, x-1/5, x+2/5, x-1/6, x+1/7, x+1/8, x-1/7, x+2/7," +
                " x-1/8, x-2/5, x+3/5, x-3/5, x+4/5, x-2/7, x+3/7, x+3/8, x-3/7, x+4/7, x-3/8, x-4, x+5, x+5/2, x-5," +
                " x+6, x-5/2, x-4/3, x+5/3, x+5/4, ...]");
        monicRationalPolynomials_int_helper(2,
                "[x^2, x^2+x, x^2+1, x^2+x+1, x^2+1/2*x, x^2+1/2, x^2+1/2*x+1/2, x^2-x, x^2+2*x, x^2-x+1, x^2+2*x+1," +
                " x^2-1/2*x, x^2-1/2*x+1/2, x^2+x+1/2, x^2-1, x^2+x-1, x^2+2, x^2+x+2, x^2-1/2, x^2+1/2*x-1/2," +
                " x^2+1/2*x+1, x^2-x-1, x^2+2*x-1, x^2-x+2, x^2+2*x+2, x^2-1/2*x-1/2, x^2+x-1/2, x^2-1/2*x+1," +
                " x^2+1/3*x, x^2+1/3, x^2+1/3*x+1/3, x^2+1/4*x, x^2+1/4, x^2+1/4*x+1/4, x^2-1/3*x, x^2+2/3*x," +
                " x^2-1/3*x+1/3, x^2+2/3*x+1/3, x^2-1/4*x, x^2-1/4*x+1/4, x^2+1/2*x+1/4, x^2-1/3, x^2+1/3*x-1/3," +
                " x^2+2/3, x^2+1/3*x+2/3, x^2-1/4, x^2+1/4*x-1/4, x^2+1/4*x+1/2, x^2-1/3*x-1/3, x^2+2/3*x-1/3, ...]");
        monicRationalPolynomials_int_helper(8,
                "[x^8, x^8+x^7, x^8+x^6, x^8+x^7+x^6, x^8+x^5, x^8+x^7+x^5, x^8+x^6+x^5, x^8+x^7+x^6+x^5, x^8+x^4," +
                " x^8+x^7+x^4, x^8+x^6+x^4, x^8+x^7+x^6+x^4, x^8+x^5+x^4, x^8+x^7+x^5+x^4, x^8+x^6+x^5+x^4," +
                " x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^8+x^7+x^3, x^8+x^6+x^3, x^8+x^7+x^6+x^3, x^8+x^5+x^3," +
                " x^8+x^7+x^5+x^3, x^8+x^6+x^5+x^3, x^8+x^7+x^6+x^5+x^3, x^8+x^4+x^3, x^8+x^7+x^4+x^3," +
                " x^8+x^6+x^4+x^3, x^8+x^7+x^6+x^4+x^3, x^8+x^5+x^4+x^3, x^8+x^7+x^5+x^4+x^3, x^8+x^6+x^5+x^4+x^3," +
                " x^8+x^7+x^6+x^5+x^4+x^3, x^8+x^2, x^8+x^7+x^2, x^8+x^6+x^2, x^8+x^7+x^6+x^2, x^8+x^5+x^2," +
                " x^8+x^7+x^5+x^2, x^8+x^6+x^5+x^2, x^8+x^7+x^6+x^5+x^2, x^8+x^4+x^2, x^8+x^7+x^4+x^2," +
                " x^8+x^6+x^4+x^2, x^8+x^7+x^6+x^4+x^2, x^8+x^5+x^4+x^2, x^8+x^7+x^5+x^4+x^2, x^8+x^6+x^5+x^4+x^2," +
                " x^8+x^7+x^6+x^5+x^4+x^2, x^8+x^3+x^2, x^8+x^7+x^3+x^2, ...]");
        monicRationalPolynomials_int_fail_helper(-2);
    }

    @Test
    public void testMonicRationalPolynomials() {
        simpleProviderHelper(QEP.monicRationalPolynomials(),
                "[1, x, x^2, x+1, x^3, x^2+x, x+1/2, x-1, x^2+1, x+2, x^4, x-1/2, x^3+x^2, x^2+x+1, x+1/3, x^3+x," +
                " x^2+1/2*x, x+1/4, x^5, x-1/3, x^2+1/2, x+2/3, x^4+x^3, x-1/4, x^3+x^2+x, x^2+1/2*x+1/2, x-2," +
                " x^2-x, x+3, x^3+1, x^2+2*x, x+3/2, x-3, x^2-x+1, x+4, x^4+x^2, x-3/2, x^3+x^2+1, x^2+2*x+1, x^6," +
                " x-2/3, x^2-1/2*x, x^3+x+1, x+3/4, x^5+x^4, x^2-1/2*x+1/2, x+4/3, x^4+x^3+x^2, x-3/4, x^3+x^2+x+1," +
                " ...]");
    }

    private static void monicRationalPolynomialsAtLeast_helper(int minDegree, @NotNull String output) {
        simpleProviderHelper(QEP.monicRationalPolynomialsAtLeast(minDegree), output);
    }

    private static void monicRationalPolynomialsAtLeast_fail_helper(int minDegree) {
        try {
            QEP.monicRationalPolynomialsAtLeast(minDegree);
            fail();
        } catch (IllegalArgumentException ignored) {}
    }

    @Test
    public void testMonicRationalPolynomialsAtLeast() {
        monicRationalPolynomialsAtLeast_helper(-1,
                "[1, x, x^2, x+1, x^3, x^2+x, x+1/2, x-1, x^2+1, x+2, x^4, x-1/2, x^3+x^2, x^2+x+1, x+1/3, x^3+x," +
                " x^2+1/2*x, x+1/4, x^5, x-1/3, x^2+1/2, x+2/3, x^4+x^3, x-1/4, x^3+x^2+x, x^2+1/2*x+1/2, x-2," +
                " x^2-x, x+3, x^3+1, x^2+2*x, x+3/2, x-3, x^2-x+1, x+4, x^4+x^2, x-3/2, x^3+x^2+1, x^2+2*x+1, x^6," +
                " x-2/3, x^2-1/2*x, x^3+x+1, x+3/4, x^5+x^4, x^2-1/2*x+1/2, x+4/3, x^4+x^3+x^2, x-3/4, x^3+x^2+x+1," +
                " ...]");
        monicRationalPolynomialsAtLeast_helper(0,
                "[1, x, x^2, x+1, x^3, x^2+x, x+1/2, x-1, x^2+1, x+2, x^4, x-1/2, x^3+x^2, x^2+x+1, x+1/3, x^3+x," +
                " x^2+1/2*x, x+1/4, x^5, x-1/3, x^2+1/2, x+2/3, x^4+x^3, x-1/4, x^3+x^2+x, x^2+1/2*x+1/2, x-2," +
                " x^2-x, x+3, x^3+1, x^2+2*x, x+3/2, x-3, x^2-x+1, x+4, x^4+x^2, x-3/2, x^3+x^2+1, x^2+2*x+1, x^6," +
                " x-2/3, x^2-1/2*x, x^3+x+1, x+3/4, x^5+x^4, x^2-1/2*x+1/2, x+4/3, x^4+x^3+x^2, x-3/4, x^3+x^2+x+1," +
                " ...]");
        monicRationalPolynomialsAtLeast_helper(1,
                "[x, x^2, x+1, x^3, x^2+x, x+1/2, x-1, x^2+1, x+2, x^4, x-1/2, x^3+x^2, x^2+x+1, x+1/3, x^3+x," +
                " x^2+1/2*x, x+1/4, x^5, x-1/3, x^2+1/2, x+2/3, x^4+x^3, x-1/4, x^3+x^2+x, x^2+1/2*x+1/2, x-2," +
                " x^2-x, x+3, x^3+1, x^2+2*x, x+3/2, x-3, x^2-x+1, x+4, x^4+x^2, x-3/2, x^3+x^2+1, x^2+2*x+1, x^6," +
                " x-2/3, x^2-1/2*x, x^3+x+1, x+3/4, x^5+x^4, x^2-1/2*x+1/2, x+4/3, x^4+x^3+x^2, x-3/4, x^3+x^2+x+1," +
                " x^2+x+1/2, ...]");
        monicRationalPolynomialsAtLeast_helper(2,
                "[x^2, x^3, x^2+x, x^2+1, x^4, x^3+x^2, x^2+x+1, x^3+x, x^2+1/2*x, x^5, x^2+1/2, x^4+x^3, x^3+x^2+x," +
                " x^2+1/2*x+1/2, x^2-x, x^3+1, x^2+2*x, x^2-x+1, x^4+x^2, x^3+x^2+1, x^2+2*x+1, x^6, x^2-1/2*x," +
                " x^3+x+1, x^5+x^4, x^2-1/2*x+1/2, x^4+x^3+x^2, x^3+x^2+x+1, x^2+x+1/2, x^2-1, x^2+x-1, x^2+2," +
                " x^4+x, x^3+1/2*x^2, x^2+x+2, x^2-1/2, x^3+1/2*x, x^2+1/2*x-1/2, x^5+x^3, x^4+x^3+x," +
                " x^3+1/2*x^2+1/2*x, x^2+1/2*x+1, x^7, x^2-x-1, x^3+1/2, x^2+2*x-1, x^2-x+2, x^4+x^2+x," +
                " x^3+1/2*x^2+1/2, x^2+2*x+2, ...]");
        monicRationalPolynomialsAtLeast_helper(8,
                "[x^8, x^9, x^8+x^7, x^8+x^6, x^10, x^9+x^8, x^8+x^7+x^6, x^8+x^5, x^9+x^7, x^8+x^7+x^5, x^11," +
                " x^8+x^6+x^5, x^10+x^9, x^9+x^8+x^7, x^8+x^7+x^6+x^5, x^8+x^4, x^9+x^6, x^8+x^7+x^4, x^8+x^6+x^4," +
                " x^10+x^8, x^9+x^8+x^6, x^8+x^7+x^6+x^4, x^12, x^8+x^5+x^4, x^9+x^7+x^6, x^8+x^7+x^5+x^4," +
                " x^11+x^10, x^8+x^6+x^5+x^4, x^10+x^9+x^8, x^9+x^8+x^7+x^6, x^8+x^7+x^6+x^5+x^4, x^8+x^3, x^9+x^5," +
                " x^8+x^7+x^3, x^8+x^6+x^3, x^10+x^7, x^9+x^8+x^5, x^8+x^7+x^6+x^3, x^8+x^5+x^3, x^9+x^7+x^5," +
                " x^8+x^7+x^5+x^3, x^11+x^9, x^8+x^6+x^5+x^3, x^10+x^9+x^7, x^9+x^8+x^7+x^5, x^8+x^7+x^6+x^5+x^3," +
                " x^13, x^8+x^4+x^3, x^9+x^6+x^5, x^8+x^7+x^4+x^3, ...]");
        monicRationalPolynomialsAtLeast_fail_helper(-2);
    }

    @Test
    public void testExponentVectors() {
        simpleProviderHelper(QEP.exponentVectors(),
                "[1, a, b, a^2, a*b, c, b^2, a^3, a^2*b, b*c, d, a*c, a*b^2, c^2, b^3, a^4, a^3*b, b^2*c, c*d," +
                " a*b*c, a*d, e, b*d, a^2*c, a^2*b^2, b*c^2, d^2, a*c^2, a*b^3, c^3, b^4, a^5, a^4*b, b^3*c, c^2*d," +
                " a*b^2*c, a*c*d, d*e, b*c*d, a^2*b*c, a^2*d, b*e, f, a*e, a*b*d, c*e, b^2*d, a^3*c, a^3*b^2," +
                " b^2*c^2, ...]");
    }

    @Test
    public void testEquals() {
        //noinspection EqualsWithItself
        assertTrue(QEP.equals(QEP));
        //noinspection ObjectEqualsNull
        assertFalse(QEP.equals(null));
        //noinspection EqualsBetweenInconvertibleTypes
        assertFalse(QEP.equals("hello"));
    }

    @Test
    public void testHashCode() {
        aeq(QEP.hashCode(), 0);
    }

    @Test
    public void testToString() {
        aeq(QEP, "QBarExhaustiveProvider");
    }
}
